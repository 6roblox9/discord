(function(){"use strict";(function(){var Te=function(){var we=Object.create,B=Object.defineProperty,Ee=Object.getOwnPropertyDescriptor,O=Object.getOwnPropertyNames,Re=Object.getPrototypeOf,Pe=Object.prototype.hasOwnProperty,y=function(t,e){return function(){return t&&(e=(0,t[O(t)[0]])(t=0)),e}},h=function(t,e){return function(){return e||(0,t[O(t)[0]])((e={exports:{}}).exports,e),e.exports}},Se=function(t,e){for(var n in e)B(t,n,{get:e[n],enumerable:!0})},G=function(t,e,n,r){if(e&&typeof e=="object"||typeof e=="function")for(var i=O(e),s=0,c=i.length,a;s<c;s++)a=i[s],!Pe.call(t,a)&&a!==n&&B(t,a,{get:function(d){return e[d]}.bind(null,a),enumerable:!(r=Ee(e,a))||r.enumerable});return t},u=function(t,e,n){return n=t!=null?we(Re(t)):{},G(e||!t||!t.__esModule?B(n,"default",{value:t,enumerable:!0}):n,t)},Be=function(t){return G(B({},"__esModule",{value:!0}),t)},J,m=y({"<define:PLUGINS_LIST>"(){J=["app-directory","char-counter","clean-urls","cloud-sync","customrpc","doom","kiryu-facecam","local-pins","message-preview","monet-theme","nexxutils","plugin-browser","plugin-embeds","song-spotlight","tenor-gif-fix","themes-plus","twemoji-everywhere","use-system-emoji","userpfp"]}}),T=h({"vendetta:@vendetta/metro/common"(t,e){m(),f(),e.exports=vendetta.metro.common}}),Me=h({"vendetta:@vendetta/plugins"(t,e){m(),f(),e.exports=vendetta.plugins}}),Ce=h({"vendetta:@vendetta/storage"(t,e){m(),f(),e.exports=vendetta.storage}}),De=h({"vendetta:@vendetta/ui/alerts"(t,e){m(),f(),e.exports=vendetta.ui.alerts}}),K=h({"vendetta:@vendetta/ui/assets"(t,e){m(),f(),e.exports=vendetta.ui.assets}}),j=h({"vendetta:@vendetta/ui/toasts"(t,e){m(),f(),e.exports=vendetta.ui.toasts}}),M=h({"vendetta:@vendetta/metro"(t,e){m(),f(),e.exports=vendetta.metro}}),Ne=h({"vendetta:@vendetta/ui"(t,e){m(),f(),e.exports=vendetta.ui}}),Ae=h({"vendetta:@vendetta/patcher"(t,e){m(),f(),e.exports=vendetta.patcher}});function F(...t){for(var e of t){if(globalThis.__turboModuleProxy){var n=globalThis.__turboModuleProxy(e);if(n)return n}if(_[e])return _[e]}}var g,o,_,W,C,Y=y({"src/stuff/deps.ts"(){m(),f(),g=u(M(),1),u(T(),1),(0,g.find)(function(t){return t?.WebView&&!t.default}).WebView,(0,g.findByProps)("SvgXml"),o=(0,g.findByProps)("useSharedValue"),(0,g.findByProps)("FlashList").FlashList,(0,g.findByProps)("isJoi"),(0,g.findByProps)("create","useStore")||(0,g.findByName)("create"),(0,g.findByProps)("createJSONStorage","persist"),(0,g.findByProps)("pickSingle","isCancel"),(0,g.findByProps)("pick","saveDocuments"),(0,g.findByProps)("MobileAudioSound").MobileAudioSound,_=window.nativeModuleProxy,F("NativeCacheModule","MMKVManager"),W=F("NativeChatModule","DCDChatManager"),C=F("NativeFileModule","DCDFileManager")}});function Oe(t,e=Z.theme){return t&&ee?.resolveSemanticColor(e,t)||"#000000"}function je(t){return(0,Q.before)("updateRows",W,function(e){var n=JSON.parse(e[1]);try{t(n)}catch(r){console.error("[nexpid.patchRows]",r)}e[1]=JSON.stringify(n)})}var v,Q,Z,I,ee,te,ne=y({"src/stuff/types.tsx"(){m(),f(),v=u(M(),1),u(T(),1),u(K(),1),u(j(),1),Q=u(Ae(),1),Y(),Z=(0,v.findByStoreName)("ThemeStore"),(0,v.findByProps)("triggerHaptic"),I=(0,v.findByProps)("colors","unsafe_rawColors"),ee=I?.internal??I?.meta,(0,v.findByProps)("useThemeContext"),te=(0,v.findByProps)("TextStyleSheet").TextStyleSheet,(0,v.findByProps)("Navigator")?.Navigator,(0,v.findByProps)("getHeaderCloseButton")?.getHeaderCloseButton,(0,v.findByProps)("popModal","pushModal")}});function x({variant:t,lineClamp:e,color:n,align:r,style:i,onPress:s,getChildren:c,children:a,liveUpdate:d,ellipsis:P}){var q=re(),[be,N]=E.React.useReducer(function(b){return~b},0);return E.React.useEffect(function(){if(d){var b=function(){return Date.now()-new Date().setMilliseconds(1e3)},S=setTimeout(function A(){N(),S=setTimeout(A,b())},b());return function(){return clearTimeout(S)}}},[]),E.React.createElement(E.ReactNative.Text,{style:[t&&te[t],n?{color:Oe(oe.semanticColors[n],q?.theme)}:{},r&&{textAlign:r},i??{}],numberOfLines:e,onPress:s,ellipsizeMode:P},c?.()??a)}var ie,E,oe,re,ae=y({"src/stuff/components/Text.tsx"(){m(),f(),ie=u(M(),1),E=u(T(),1),oe=u(Ne(),1),ne(),{useThemeContext:re}=(0,ie.findByProps)("useThemeContext")}}),se,k,Fe=y({"src/stuff/components/RichText.tsx"(){m(),f(),se=u(T(),1),ae(),function(t){function e({children:r,onPress:i}){return React.createElement(x,{variant:"text-md/bold",onPress:i},r)}t.Bold=e;function n({children:r,onPress:i}){return React.createElement(se.ReactNative.Text,{style:{textDecorationLine:"underline"},onPress:i},r)}t.Underline=n}(k||(k={}))}}),ue,le,ce,de,me,p,D,_e=y({"src/stuff/lib/redesign/index.tsx"(){m(),f(),ue=u(M(),1),le=u(T(),1),ce=u(j(),1),de=function(t,e){return function(){var n=function(){(0,ce.showToast)(`${t} not found! Search for PNF in Debug Logs!`),console.warn(`!! PNF ERROR !!
Missing the redesign ${e?"function":"component"}: ${t}. Please bug @nexpid about this on Discord!`)};return e?n():le.React.useEffect(n,[]),null}},me=function(...t){return(0,ue.findByProps)(...t)?.[t[0]]},p=function(t,...e){return me(...e)??de(e[0],t)},p(!1,"Button"),p(!1,"RowButton"),p(!1,"FloatingActionButton"),p(!1,"PressableScale"),p(!1,"IconButton"),p(!1,"ContextMenu"),p(!1,"Slider"),p(!1,"TextInput"),p(!1,"Tabs"),p(!1,"SegmentedControlPages"),p(!1,"Card"),D=p(!1,"Stack"),p(!0,"useSegmentedControlState")}});function fe(t,e,n,r,i,s,c){try{var a=t[s](c),d=a.value}catch(P){n(P);return}a.done?e(d):Promise.resolve(d).then(r,i)}function pe(t){return function(){var e=this,n=arguments;return new Promise(function(r,i){var s=t.apply(e,n);function c(d){fe(s,r,i,c,a,"next",d)}function a(d){fe(s,r,i,c,a,"throw",d)}c(void 0)})}}function Ie({affectedPlugin:t,domains:e}){var n=o.useSharedValue(0),r=o.useSharedValue("0deg"),i=o.useSharedValue(1),s=o.useSharedValue(1),[c,a]=l.React.useState(!0),d=300,P=-10,q=30,be=11,N={duration:0},b=1.25,S={duration:d*2,easing:o.Easing.out(o.Easing.quad)},A=.9;return l.React.useEffect(function(){if(!c){n.value=0,r.value="0deg",i.value=1,s.value=1;return}n.value=o.withRepeat(o.withSequence(o.withTiming(q,{easing:o.Easing.out(o.Easing.quad),duration:d}),o.withTiming(P,{easing:o.Easing.quad,duration:d})),-1),r.value=o.withRepeat(o.withSequence(o.withTiming("0deg",{duration:d*2*be}),o.withTiming("-360deg",{duration:d*2,easing:o.Easing.out(o.Easing.exp)})),-1),i.value=o.withRepeat(o.withSequence(o.withTiming(b,N),o.withTiming(A,S)),-1),s.value=o.withRepeat(o.withSequence(o.withTiming(1/b,N),o.withTiming(1/A,S)),-1)},[c]),l.React.createElement(D,{direction:"vertical",spacing:8},l.React.createElement(D,{direction:"horizontal",spacing:14,style:{justifyContent:"center",alignItems:"center",marginBottom:18,marginHorizontal:8}},l.React.createElement(he,{style:{width:80,height:80},pointerEvents:"box-only",onPress:function(){return a(!c)},accessibilityRole:"togglebutton",accessibilityLabel:"toggle jumping animation"},l.React.createElement(o.default.Image,{source:{uri:"https://api.lanyard.rest/853550207039832084.webp?size=128",width:128,height:128},style:[{borderRadius:40,width:80,height:80,position:"absolute",bottom:0},{bottom:n,transform:[{scaleX:i},{scaleY:s},{rotate:r}]}]})),l.React.createElement(D,{direction:"vertical",style:{flex:1}},l.React.createElement(x,{variant:"heading-xl/extrabold",color:"TEXT_DEFAULT",style:{flex:0}},"Hey, it's me, nexpid!"),l.React.createElement(x,{variant:"heading-md/medium",color:"TEXT_DEFAULT",style:{flex:0}},"You might know me. I made ",t?l.React.createElement(l.React.Fragment,null,"a plugin you use, ",l.React.createElement(k.Bold,null,t)):"some of the plugins you use","!"))),l.React.createElement(x,{variant:"text-md/medium",color:"TEXT_DEFAULT"},t?"The plugin you use has":"Some of my plugins you use have"," one of these domains:"),l.React.createElement(x,{variant:"text-md/bold",color:"TEXT_DEFAULT",style:{marginHorizontal:10}},e.map(function($e){return`\u2022 ${$e}`}).join(`
`)),l.React.createElement(x,{variant:"text-md/medium",color:"TEXT_DEFAULT"},"These domains are being deprecated and plugins on them won't receive any new updates. Please use the new domain instead:"),l.React.createElement(x,{variant:"text-lg/bold",color:"TEXT_DEFAULT",style:{textDecorationLine:"underline"},align:"center"},"revenge.nexpid.xyz"))}function ke(){return L.apply(this,arguments)}function L(){return L=pe(function*(){var t=function(i){var s=ye.find(function(a){return a.match.test(i)}),c=s&&i.match(s.match)?.groups?.plugin;c&&ve.includes(c)&&(e.push({id:c,link:i,name:w.plugins[i].manifest.name}),n.add(s.label),i.includes("bn-plugins.github.io/vd-proxy")&&n.add("proxied plugin links"))};if(!(yield C.fileExists(`${C.DocumentsDirPath}/${V}`))){var e=[],n=new Set;for(var r of Object.keys(w.plugins))t(r);n.size&&(0,ge.showConfirmationAlert)({children:l.React.createElement(Ie,{affectedPlugin:e.length===1?e[0].name:void 0,domains:[...n.values()]}),confirmText:"Migrate now",onConfirm(){return pe(function*(){(0,R.showToast)("Starting migration"),console.log("MIGRATION STARTS HERE, AFFECTED",e);try{for(var{id:i,link:s,name:c}of e){var a=`https://revenge.nexpid.xyz/${U[i]??i}/`;console.log("FROM",s,"TO",a),yield(0,z.createMMKVBackend)(a).set(yield(0,z.createMMKVBackend)(s).get()),w.plugins[a]||(yield(0,w.installPlugin)(a)),yield(0,w.removePlugin)(s),(0,R.showToast)(`Migrated ${c}`)}console.log("MIGRATION ENDS HERE")}catch(d){return console.error("Migration error",d),(0,R.showToast)(`Got an error! ${d} (ping nexpid about this!!!)`,(0,$.getAssetIDByName)("CircleXIcon-primary"))}(0,R.showToast)("Migrated successfully! Please reload your client to apply changes",(0,$.getAssetIDByName)("CircleCheckIcon-primary"))})()},cancelText:"Remind me later",secondaryConfirmText:"I understand (don't show again)",onConfirmSecondary(){C.writeFile("documents",V,"revenged","utf8")}})}}),L.apply(this,arguments)}var l,w,z,ge,$,R,he,U,ve,ye,V,Le=y({"src/stuff/migration.tsx"(){m(),f(),l=u(T(),1),w=u(Me(),1),z=u(Ce(),1),ge=u(De(),1),$=u(K(),1),R=u(j(),1),Fe(),ae(),Y(),_e(),{Pressable:he}=l.ReactNative,U={usrpfp:"userpfp"},ve=[J,Object.keys(U)].flat(),ye=[{match:RegExp("vendetta\\.nexpid\\.xyz\\/(?<plugin>.+)\\/$","i"),label:"vendetta.nexpid.xyz"},{match:RegExp("dev\\.bunny\\.nexpid\\.xyz\\/(?<plugin>.+)\\/$","i"),label:"dev.bunny.nexpid.xyz"},{match:RegExp("bunny\\.nexpid\\.xyz\\/(?<plugin>.+)\\/$","i"),label:"bunny.nexpid.xyz"}],V="nexpid/revengemigration.txt"}}),X,f=y({"scripts/build/modules/workers/migration-shim.ts"(){Le(),X=Symbol.for("nexpid revenge migration"),window[X]||(window[X]=!0,ke())}}),xe={};Se(xe,{onUnload:function(){return ze}}),m(),f(),ne();function H(t){var e=[],n;for(var r of t){var i=r;i.type==="emoji"&&(i={type:"text",content:i.surrogate}),"content"in i&&Array.isArray(i.content)&&(i.content=H(i.content)),"items"in i&&Array.isArray(i.items)&&(i.items=H(i.items)),"jumboable"in r&&r.jumboable&&!n&&(n={type:"heading",level:1,content:[]}),(r.type==="emoji"||r.type==="customEmoji")&&!r.jumboable&&n&&(e.push(n),n=void 0),n?n.content.push(i):e.push(i)}return n&&e.push(n),e}var ze=je(function(t){for(var e of t)e.type===1&&e.message.content&&(e.message.content=H(e.message.content))});return Be(xe)}();return Te})()})();
