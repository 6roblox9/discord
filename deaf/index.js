(function(s,c,l,o){"use strict";const m=l.findByProps("getCurrentUser"),i=l.findByProps("getAPIBaseURL","patch","post");function d(n,a){return n.find(function(e){return e.name===a})?.value}async function u(n,a){await i.post({url:`/channels/${n}/messages`,body:{content:a}})}async function f(n){const a=await fetch(n);if(!a.ok)throw new Error("Failed to fetch JSON");return await a.json()}async function w(n){await i.patch({url:"/users/@me",body:{username:n.username,global_name:n.global_name,bio:n.bio,pronouns:n.pronouns}}),"avatar"in n&&await i.patch({url:"/users/@me",body:{avatar:n.avatar}}),"banner"in n&&await i.patch({url:"/users/@me",body:{banner:n.banner}})}function b(){const n=m.getCurrentUser();return{username:n.username,global_name:n.globalName,bio:n.bio,pronouns:n.pronouns,avatar:n.avatar,banner:n.banner}}var p={onLoad(){c.registerCommand({name:"profile",description:"Save / Load profile",options:[{name:"action",type:3,required:!0},{name:"link",type:3,required:!1}],execute:async function(n,a){try{const e=d(n,"action")?.toLowerCase(),r=d(n,"link");if(e==="save"&&!r){const t=b();await u(a.channel.id,"```json\n"+JSON.stringify(t,null,2)+"\n```"),o.showToast("Profile saved");return}if(e==="load"&&r){const t=await f(r);await w(t),o.showToast("Profile loaded");return}if(e==="save"&&r){const t=await f(r);await u(a.channel.id,"```json\n"+JSON.stringify(t,null,2)+"\n```"),o.showToast("JSON sent");return}throw new Error("Invalid arguments")}catch(e){await u(a.channel.id,`\u274C Error: ${e.message}`),o.showToast("Profile error")}}})},onUnload(){c.unregisterAllCommands()}};return s.default=p,Object.defineProperty(s,"__esModule",{value:!0}),s})({},vendetta.commands,vendetta.metro,vendetta.ui.toasts);
