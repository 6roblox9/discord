(function(s,c,l,r){"use strict";const f=l.findByProps("getCurrentUser"),i=l.findByProps("getAPIBaseURL","patch","post"),p=l.findByProps("uploadFile");async function w(a,n){await i.post({url:`/channels/${a}/messages`,body:{content:n}})}async function u(a){const n=await fetch(a);if(!n.ok)throw new Error("Failed to fetch JSON");return await n.json()}async function d(a,n){const e=new Blob([JSON.stringify(n,null,2)],{type:"application/json"});await p.upload({channelId:a,file:e,filename:"profile.json"})}async function m(a){await i.patch({url:"/users/@me",body:{username:a.username,global_name:a.global_name,bio:a.bio,pronouns:a.pronouns}}),"avatar"in a&&await i.patch({url:"/users/@me",body:{avatar:a.avatar}}),"banner"in a&&await i.patch({url:"/users/@me",body:{banner:a.banner}})}function b(){const a=f.getCurrentUser();return{username:a.username,global_name:a.globalName,bio:a.bio,pronouns:a.pronouns,avatar:a.avatar,banner:a.banner}}var h={onLoad(){c.registerCommand({name:"profile",description:"Save / Load profile",options:[{name:"action",type:3,required:!0},{name:"link",type:3,required:!1}],execute:async function(a,n){try{const e=a.action?.toLowerCase(),o=a.link;if(e==="save"&&!o){const t=b();await d(n.channel.id,t),r.showToast("Profile saved")}else if(e==="load"&&o){const t=await u(o);await m(t),r.showToast("Profile loaded")}else if(e==="save"&&o){const t=await u(o);await d(n.channel.id,t),r.showToast("JSON sent")}else throw new Error("Invalid arguments")}catch(e){await w(n.channel.id,`\u274C Error: ${e.message}`),r.showToast("Profile error")}}})},onUnload(){c.unregisterAllCommands()}};return s.default=h,Object.defineProperty(s,"__esModule",{value:!0}),s})({},vendetta.commands,vendetta.metro,vendetta.ui.toasts);
