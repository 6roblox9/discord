(function(i,l,f,r){"use strict";const s=f.findByProps("getAPIBaseURL","patch","post","get");function u(n,e){return n.find(function(o){return o.name===e})?.value}async function c(n,e){await s.post({url:`/channels/${n}/messages`,body:{content:e}})}async function d(n){const e=await fetch(n);if(!e.ok)throw new Error("Failed to fetch JSON");return await e.json()}async function m(){const n=await s.get({url:"/users/@me/profile"});return{username:n.user.username,global_name:n.user.global_name,bio:n.bio,pronouns:n.pronouns,accent_color:n.accent_color,theme_colors:n.theme_colors}}async function w(n){await s.patch({url:"/users/@me",body:{username:n.username,global_name:n.global_name}}),await s.patch({url:"/users/@me/profile",body:{bio:n.bio??"",pronouns:n.pronouns??"",accent_color:n.accent_color??null,theme_colors:n.theme_colors??null}})}var h={onLoad(){l.registerCommand({name:"profile",description:"Save / Load profile",options:[{name:"action",type:3,required:!0},{name:"link",type:3,required:!1}],execute:async function(n,e){try{const o=u(n,"action")?.toLowerCase(),a=u(n,"link");if(o==="save"&&!a){const t=await m();await c(e.channel.id,"```json\n"+JSON.stringify(t,null,2)+"\n```"),r.showToast("Profile saved");return}if(o==="load"&&a){const t=await d(a);await w(t),r.showToast("Profile loaded");return}if(o==="save"&&a){const t=await d(a);await c(e.channel.id,"```json\n"+JSON.stringify(t,null,2)+"\n```"),r.showToast("JSON sent");return}throw new Error("Invalid arguments")}catch(o){await c(e.channel.id,`\u274C Error: ${o.message}`),r.showToast("Profile error")}}})},onUnload(){l.unregisterAllCommands()}};return i.default=h,Object.defineProperty(i,"__esModule",{value:!0}),i})({},vendetta.commands,vendetta.metro,vendetta.ui.toasts);
