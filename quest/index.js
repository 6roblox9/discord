(function(g,c,v,d,r,e){"use strict";const{reload:E}=c.findByProps("reload");function S(){const[n,o]=e.React.useState(r.storage.userIds.join(",")),[t,a]=e.React.useState(r.storage.trackFriends);function s(){e.ReactNative.Alert.alert("Apply?","Are you sure to apply changes?",[{text:"nope",style:"cancel"},{text:"yep",onPress:function(){r.storage.userIds=n.split(",").map(function(i){return i.trim()}).filter(Boolean),r.storage.trackFriends=t,d.showToast("settings saved"),E()}}])}return e.React.createElement(e.ReactNative.ScrollView,{style:{flex:1,backgroundColor:"#1e1f22",padding:20}},e.React.createElement(e.ReactNative.View,{style:{backgroundColor:"#2b2d31",padding:16,borderRadius:12,marginBottom:16}},e.React.createElement(e.ReactNative.View,{style:{flexDirection:"row",justifyContent:"space-between",alignItems:"center"}},e.React.createElement(e.ReactNative.Text,{style:{color:"#fff",fontSize:16,fontWeight:"600"}},"Track Friends"),e.React.createElement(e.ReactNative.Switch,{value:t,onValueChange:a}))),e.React.createElement(e.ReactNative.View,{style:{backgroundColor:"#2b2d31",padding:16,borderRadius:12,marginBottom:20}},e.React.createElement(e.ReactNative.Text,{style:{color:"#fff",fontSize:15,marginBottom:8}},"Specific User IDs"),e.React.createElement(e.ReactNative.TextInput,{value:n,onChangeText:o,placeholder:"123, 456, 789",placeholderTextColor:"#888",style:{backgroundColor:"#1e1f22",borderRadius:8,padding:12,color:"#fff",fontSize:14}})),e.React.createElement(e.ReactNative.TouchableOpacity,{onPress:s,style:{backgroundColor:"#5865f2",paddingVertical:14,borderRadius:10,alignItems:"center"}},e.React.createElement(e.ReactNative.Text,{style:{color:"#fff",fontSize:16,fontWeight:"bold"}},"Apply")))}const u=c.findByProps("dispatch","subscribe"),w=c.findByProps("getStatus"),I=c.findByProps("getFriendIDs"),R=c.findByProps("getChannel"),y=c.findByProps("getGuild"),C=c.findByProps("getUser");r.storage.trackFriends===void 0&&(r.storage.trackFriends=!0),r.storage.userIds||(r.storage.userIds=[]);const p={},f=function(){const n=new Set;if(r.storage.trackFriends)for(const o of I.getFriendIDs())n.add(o);for(const o of r.storage.userIds)n.add(o);return[...n]},l=function(n){return C.getUser(n)?.username??n};let h=null,T=null,b=null;var $={onLoad(){for(const t of f())p[t]=w.getStatus(t);h=v.after("dispatch",u,function([t]){if(t?.type!=="PRESENCE_UPDATE")return;const a=t.user?.id;f().includes(a)&&p[a]!==t.status&&(p[a]=t.status,d.showToast(`${l(a)} is now ${t.status}`))});const n=function(t){const a=t?.message,s=a?.author?.id;if(!f().includes(s))return;const i=R.getChannel(a.channel_id);if(i)if(i.guild_id){const N=y.getGuild(i.guild_id);d.showToast(`${l(s)} messaged in ${N?.name} #${i.name}`)}else i.type===3?d.showToast(`${l(s)} messaged in group`):d.showToast(`${l(s)} messaged in DM`)},o=function(t){const a=t?.userId;if(!f().includes(a))return;const s=R.getChannel(t.channelId);if(s)if(s.guild_id){const i=y.getGuild(s.guild_id);d.showToast(`${l(a)} typing in ${i?.name} #${s.name}`)}else s.type===3?d.showToast(`${l(a)} typing in group`):d.showToast(`${l(a)} typing in DM`)};u.subscribe("MESSAGE_CREATE",n),u.subscribe("TYPING_START",o),T=function(){return u.unsubscribe("MESSAGE_CREATE",n)},b=function(){return u.unsubscribe("TYPING_START",o)}},onUnload(){h?.(),T?.(),b?.()},settings:S};return g.default=$,Object.defineProperty(g,"__esModule",{value:!0}),g})({},vendetta.metro,vendetta.patcher,vendetta.ui.toasts,vendetta.plugin,vendetta.metro.common);
