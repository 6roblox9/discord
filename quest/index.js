(function(_,p,o,n,h){"use strict";function y(){h.useProxy(o.storage);const t=o.storage.logs||[];return n.React.createElement(n.ReactNative.View,{style:{flex:1,backgroundColor:"#202225"}},n.React.createElement(n.ReactNative.View,{style:{padding:16,borderBottomWidth:1,borderBottomColor:"#2f3136"}},n.React.createElement(n.ReactNative.Text,{style:{color:"#fff",fontSize:20,fontWeight:"bold"}},"Quest Logs")),n.React.createElement(n.ReactNative.ScrollView,{style:{flex:1,padding:12}},t.length===0?n.React.createElement(n.ReactNative.Text,{style:{color:"#8e9297",textAlign:"center",marginTop:20}},"Waiting for tasks..."):t.map(function(e,a){return n.React.createElement(n.ReactNative.View,{key:a,style:{marginBottom:6,flexDirection:"row"}},n.React.createElement(n.ReactNative.Text,{style:{color:"#72767d",fontSize:11,width:80}},"[",e.time,"]"),n.React.createElement(n.ReactNative.Text,{style:{color:e.color,fontWeight:"500",flex:1}},e.message))})),n.React.createElement(n.ReactNative.TouchableOpacity,{onPress:function(){o.storage.logs=[]},style:{backgroundColor:"#f04747",margin:16,padding:12,borderRadius:8,alignItems:"center"}},n.React.createElement(n.ReactNative.Text,{style:{color:"#fff",fontWeight:"bold"}},"Clear Logs")))}const b=p.findByProps("getToken").getToken,w={os:"Windows",browser:"Discord Client",release_channel:"stable",client_version:"1.0.9215",os_version:"10.0.19045",os_arch:"x64",app_arch:"x64",system_locale:"en-US",has_client_mods:!1,client_launch_id:Math.random().toString(36),browser_user_agent:"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) discord/1.0.9215 Chrome/138.0.7204.251 Electron/37.6.0 Safari/537.36",browser_version:"37.6.0",os_sdk_version:"19045",client_build_number:471091,native_build_number:72186,client_event_source:null,launch_signature:Math.random().toString(36),client_heartbeat_session_id:Math.random().toString(36),client_app_state:"focused"},m=btoa(JSON.stringify(w));function s(t,e){const a=new Date().toLocaleTimeString();o.storage.logs||(o.storage.logs=[]),o.storage.logs.push({time:a,color:t,message:e})}const f=function(t){return new Promise(function(e){return setTimeout(e,t)})};async function v(t,e=5){for(let a=0;a<e;a++)try{return await t()}catch{await f(3e3)}}async function c(t,e="GET",a){const r=b();return(await v(function(){return fetch(`https://discord.com/api/v10${t}`,{method:e,headers:{Authorization:r,"Content-Type":"application/json","x-super-properties":m,"User-Agent":w.browser_user_agent},body:a?JSON.stringify(a):void 0})})).json()}async function $(t){return((await c("/quests/@me")).quests||[]).find(function(e){return e.id===t})}async function k(t,e){const a=t.config?.messages?.quest_name||"Unknown Quest",r=t.id,u=t.config?.task_config?.tasks[e];if(!u)return;const l=u.target;let i=t.user_status?.progress?.[e]?.value||0,d=0;if(s("#faa81a",`${a} type: ${e}`),e.includes("WATCH_VIDEO"))for(;i<l;){const g=await c(`/quests/${r}/video-progress`,"POST",{timestamp:Math.min(l,i+7+Math.random())});if(i+=7,Date.now()-d>=1e4&&(s("#00bfff",`${a} ${Math.min(i,l)}/${l} remaining ${Math.max(0,l-i)}`),d=Date.now()),g.completed_at)break;await f(2e3)}else{for(;;){const g=await c(`/quests/${r}/heartbeat`,"POST",{application_id:t.config.application.id,terminal:!1});if(i=g.progress?.[e]?.value||i,Date.now()-d>=1e4&&(s("#00bfff",`${a} ${i}/${l} remaining ${Math.max(0,l-i)}`),d=Date.now()),g.completed_at)break;await f(3e4)}await c(`/quests/${r}/heartbeat`,"POST",{application_id:t.config.application.id,terminal:!0})}s("#36e333",`${a} ${e} completed`)}async function R(t){let e=t;if(!(!e||!e.config)){for(e.user_status?.enrolled_at||await c(`/quests/${e.id}/enroll`,"POST",{location:11,is_targeted:!1,metadata_raw:null});e=await $(e.id),!(!e||e.user_status?.completed_at);){const a=Object.keys(e.config?.task_config?.tasks||{}).filter(function(r){const u=e.config.task_config.tasks[r];return(e.user_status?.progress?.[r]?.value||0)<u.target});if(!a.length)break;await k(e,a[0]),await f(3e3)}e&&e.config&&s("#36e333",`${e.config.messages.quest_name} fully completed`)}}async function T(){o.storage.logs=[];try{const t=await c("/users/@me");t.id&&s("#36e333",`Logged ${t.username}#${t.discriminator}`);const e=((await c("/quests/@me")).quests||[]).filter(function(a){return a.config&&!a.user_status?.completed_at&&new Date(a.config.expires_at)>new Date});s("#faa81a",`Quests found: ${e.length}`);for(const a of e)await R(a),await f(2e3);s("#36e333","All quests finished")}catch(t){s("#ff4747",`Fatal Error: ${t.message}`)}}var x={onLoad(){T()},onUnload(){},settings:y};return _.default=x,Object.defineProperty(_,"__esModule",{value:!0}),_})({},vendetta.metro,vendetta.plugin,vendetta.metro.common,vendetta.storage);
