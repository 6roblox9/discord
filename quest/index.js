(function(g,p,s,a,w){"use strict";function h(){return w.useProxy(s.storage),a.React.createElement(a.ReactNative.ScrollView,{style:{flex:1,backgroundColor:"#2f3136",padding:16}},a.React.createElement(a.ReactNative.Text,{style:{color:"#fff",fontSize:20,fontWeight:"bold",marginBottom:12}},"Quest Automator Logs"),a.React.createElement(a.ReactNative.View,{style:{backgroundColor:"#202225",borderRadius:8,padding:12,borderLeftWidth:4,borderLeftColor:"#7289da"}},s.storage.logs&&s.storage.logs.length>0?s.storage.logs.map(function(t,e){return a.React.createElement(a.ReactNative.View,{key:e,style:{marginBottom:6,flexDirection:"row",flexWrap:"wrap"}},a.React.createElement(a.ReactNative.Text,{style:{color:"#8e9297",fontSize:12}},"[",t.time,"]"),a.React.createElement(a.ReactNative.Text,{style:{color:t.color,fontSize:13,marginLeft:6,fontWeight:"500"}},t.message))}):a.React.createElement(a.ReactNative.Text,{style:{color:"#72767d",italic:!0}},"No activity recorded yet.")),a.React.createElement(a.ReactNative.TouchableOpacity,{onPress:function(){s.storage.logs=[]},style:{marginTop:20,backgroundColor:"#4e5d94",padding:14,borderRadius:8,alignItems:"center"}},a.React.createElement(a.ReactNative.Text,{style:{color:"#fff",fontWeight:"bold"}},"Clear Logs")))}const b=p.findByProps("getToken").getToken,_={os:"Windows",browser:"Discord Client",release_channel:"stable",client_version:"1.0.9215",os_version:"10.0.19045",os_arch:"x64",app_arch:"x64",system_locale:"en-US",has_client_mods:!1,client_launch_id:Math.random().toString(36),browser_user_agent:"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) discord/1.0.9215 Chrome/138.0.7204.251 Electron/37.6.0 Safari/537.36",browser_version:"37.6.0",os_sdk_version:"19045",client_build_number:471091,native_build_number:72186,client_event_source:null,launch_signature:Math.random().toString(36),client_heartbeat_session_id:Math.random().toString(36),client_app_state:"focused"},m=btoa(JSON.stringify(_));function r(t,e){const n=new Date().toLocaleTimeString();s.storage.logs||(s.storage.logs=[]),s.storage.logs.push({time:n,color:t,message:e})}const u=function(t){return new Promise(function(e){return setTimeout(e,t)})};async function y(t,e=5){for(let n=0;n<e;n++)try{return await t()}catch{await u(3e3)}}async function l(t,e="GET",n){const c=b();return(await y(function(){return fetch(`https://discord.com/api/v10${t}`,{method:e,headers:{Authorization:c,"Content-Type":"application/json","x-super-properties":m,"User-Agent":_.browser_user_agent},body:n?JSON.stringify(n):void 0})})).json()}async function v(t){return((await l("/quests/@me")).quests||[]).find(function(e){return e.id===t})}async function $(t,e){const n=t.config.messages.quest_name,c=t.id,i=t.config.task_config.tasks[e].target;let o=t.user_status?.progress?.[e]?.value||0,d=0;if(r("#faa81a",`${n} type: ${e}`),e.includes("WATCH_VIDEO"))for(;o<i;){const f=await l(`/quests/${c}/video-progress`,"POST",{timestamp:Math.min(i,o+7+Math.random())});if(o+=7,Date.now()-d>=1e4&&(r("#00bfff",`${n} ${Math.min(o,i)}/${i} remaining ${Math.max(0,i-o)}`),d=Date.now()),f.completed_at)break;await u(2e3)}else{for(;;){const f=await l(`/quests/${c}/heartbeat`,"POST",{application_id:t.config.application.id,terminal:!1});if(o=f.progress?.[e]?.value||o,Date.now()-d>=1e4&&(r("#00bfff",`${n} ${o}/${i} remaining ${Math.max(0,i-o)}`),d=Date.now()),f.completed_at)break;await u(3e4)}await l(`/quests/${c}/heartbeat`,"POST",{application_id:t.config.application.id,terminal:!0})}r("#36e333",`${n} ${e} completed`)}async function k(t){let e=t;for(e.user_status?.enrolled_at||await l(`/quests/${e.id}/enroll`,"POST",{location:11,is_targeted:!1,metadata_raw:null});e=await v(e.id),!(!e||e.user_status?.completed_at);){const n=Object.keys(e.config.task_config.tasks).filter(function(c){const i=e.config.task_config.tasks[c].target;return(e.user_status?.progress?.[c]?.value||0)<i});if(!n.length)break;await $(e,n[0]),await u(3e3)}r("#36e333",`${e.config.messages.quest_name} fully completed`)}async function R(){s.storage.logs=[];try{const t=await l("/users/@me");for(r("#36e333",`Logged ${t.username}#${t.discriminator}`);;){const e=((await l("/quests/@me")).quests||[]).filter(function(n){return!n.user_status?.completed_at&&new Date(n.config.expires_at)>new Date});if(e.length===0)break;r("#faa81a",`Quests remaining: ${e.length}`),await k(e[0]),await u(3e3)}r("#36e333","All quests finished")}catch(t){r("#ff4747",`Error: ${t.message}`)}}var T={onLoad(){R()},onUnload(){},settings:h};return g.default=T,Object.defineProperty(g,"__esModule",{value:!0}),g})({},vendetta.metro,vendetta.plugin,vendetta.metro.common,vendetta.storage);
