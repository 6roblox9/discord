(function(g,u,E,o,r,e){"use strict";function S(){const[a,d]=e.React.useState((r.storage.userIds??[]).join(",")),[t,n]=e.React.useState(r.storage.trackFriends??!0);function s(){r.storage.userIds=a.split(",").map(function(i){return i.trim()}).filter(Boolean),r.storage.trackFriends=t,o.showToast("settings applied")}return e.React.createElement(e.ReactNative.ScrollView,{style:{flex:1,padding:16,backgroundColor:"#2f3136"}},e.React.createElement(e.ReactNative.Text,{style:{color:"#fff",fontSize:16,marginBottom:6}},"Track Friends"),e.React.createElement(e.ReactNative.Switch,{value:t,onValueChange:n,style:{marginBottom:16}}),e.React.createElement(e.ReactNative.Text,{style:{color:"#fff",fontSize:16,marginBottom:6}},"Specific User IDs"),e.React.createElement(e.ReactNative.TextInput,{value:a,onChangeText:d,placeholder:"123, 456, 789",placeholderTextColor:"#aaa",style:{borderWidth:1,borderColor:"#7289da",padding:10,borderRadius:8,color:"#fff",backgroundColor:"#202225",marginBottom:16}}),e.React.createElement(e.ReactNative.TouchableOpacity,{onPress:s,style:{backgroundColor:"#7289da",paddingVertical:12,borderRadius:8,alignItems:"center"}},e.React.createElement(e.ReactNative.Text,{style:{color:"#fff",fontSize:16,fontWeight:"bold"}},"Apply")))}const l=u.findByProps("dispatch","subscribe"),v=u.findByProps("getStatus"),I=u.findByProps("getFriendIDs"),T=u.findByProps("getChannel"),p=u.findByProps("getGuild"),C=u.findByProps("getUser");r.storage.trackFriends===void 0&&(r.storage.trackFriends=!0),r.storage.userIds||(r.storage.userIds=[]);const h={},f=function(){const a=new Set;if(r.storage.trackFriends)for(const d of I.getFriendIDs())a.add(d);for(const d of r.storage.userIds)a.add(d);return[...a]},c=function(a){return C.getUser(a)?.username??a};let R=null,y=null,b=null;var _={onLoad(){for(const t of f())h[t]=v.getStatus(t);R=E.after("dispatch",l,function([t]){if(t?.type!=="PRESENCE_UPDATE")return;const n=t.user?.id;f().includes(n)&&h[n]!==t.status&&(h[n]=t.status,o.showToast(`${c(n)} is now ${t.status}`))});const a=function(t){const n=t?.message,s=n?.author?.id;if(!f().includes(s))return;const i=T.getChannel(n.channel_id);if(i)if(i.guild_id){const $=p.getGuild(i.guild_id);o.showToast(`${c(s)} messaged in ${$?.name} #${i.name}`)}else i.type===3?o.showToast(`${c(s)} messaged in group`):o.showToast(`${c(s)} messaged in DM`)},d=function(t){const n=t?.userId;if(!f().includes(n))return;const s=T.getChannel(t.channelId);if(s)if(s.guild_id){const i=p.getGuild(s.guild_id);o.showToast(`${c(n)} typing in ${i?.name} #${s.name}`)}else s.type===3?o.showToast(`${c(n)} typing in group`):o.showToast(`${c(n)} typing in DM`)};l.subscribe("MESSAGE_CREATE",a),l.subscribe("TYPING_START",d),y=function(){return l.unsubscribe("MESSAGE_CREATE",a)},b=function(){return l.unsubscribe("TYPING_START",d)}},onUnload(){R?.(),y?.(),b?.()},settings:S};return g.default=_,Object.defineProperty(g,"__esModule",{value:!0}),g})({},vendetta.metro,vendetta.patcher,vendetta.ui.toasts,vendetta.plugin,vendetta.metro.common);
