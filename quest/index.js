(function(g,l,S,c,r,e){"use strict";function w({applyCallback:s}){const[i,t]=e.React.useState(r.storage.userIds.join(",")),[a,n]=e.React.useState(r.storage.trackFriends);function d(){r.storage.userIds=i.split(",").map(function(h){return h.trim()}).filter(Boolean),r.storage.trackFriends=a,c.showToast("saved"),s?.()}return e.React.createElement(e.ReactNative.ScrollView,{style:{flex:1,backgroundColor:"#1e1f22",padding:20}},e.React.createElement(e.ReactNative.View,{style:{backgroundColor:"#2b2d31",padding:16,borderRadius:12,marginBottom:16}},e.React.createElement(e.ReactNative.View,{style:{flexDirection:"row",justifyContent:"space-between",alignItems:"center"}},e.React.createElement(e.ReactNative.Text,{style:{color:"#fff",fontSize:16,fontWeight:"600"}},"Track Friends"),e.React.createElement(e.ReactNative.Switch,{value:a,onValueChange:n}))),e.React.createElement(e.ReactNative.View,{style:{backgroundColor:"#2b2d31",padding:16,borderRadius:12,marginBottom:20}},e.React.createElement(e.ReactNative.Text,{style:{color:"#fff",fontSize:15,marginBottom:8}},"Specific User IDs"),e.React.createElement(e.ReactNative.TextInput,{value:i,onChangeText:t,placeholder:"123, 456, 789",placeholderTextColor:"#888",style:{backgroundColor:"#1e1f22",borderRadius:8,padding:12,color:"#fff",fontSize:14}})),e.React.createElement(e.ReactNative.TouchableOpacity,{onPress:d,style:{backgroundColor:"#5865f2",paddingVertical:14,borderRadius:10,alignItems:"center"}},e.React.createElement(e.ReactNative.Text,{style:{color:"#fff",fontSize:16,fontWeight:"bold"}},"Apply")))}const u=l.findByProps("dispatch","subscribe"),C=l.findByProps("getStatus"),I=l.findByProps("getFriendIDs"),T=l.findByProps("getChannel"),E=l.findByProps("getGuild"),k=l.findByProps("getUser");r.storage.trackFriends===void 0&&(r.storage.trackFriends=!0),r.storage.userIds||(r.storage.userIds=[]);const R={},f=function(){const s=new Set;if(r.storage.trackFriends)for(const i of I.getFriendIDs())s.add(i);for(const i of r.storage.userIds)s.add(i);return[...s]},o=function(s){return k.getUser(s)?.username??s};let b=null,p=null,y=null;const v=function(){for(const t of f())R[t]=C.getStatus(t);b?.(),p?.(),y?.(),b=S.after("dispatch",u,function([t]){if(t?.type!=="PRESENCE_UPDATE")return;const a=t.user?.id;f().includes(a)&&R[a]!==t.status&&(R[a]=t.status,c.showToast(`${o(a)} is now ${t.status}`))});const s=function(t){const a=t?.message,n=a?.author?.id;if(!f().includes(n))return;const d=T.getChannel(a.channel_id);if(d)if(d.guild_id){const h=E.getGuild(d.guild_id);c.showToast(`${o(n)} messaged in ${h?.name} #${d.name}`)}else d.type===3?c.showToast(`${o(n)} messaged in group`):c.showToast(`${o(n)} messaged in DM`)},i=function(t){const a=t?.userId;if(!f().includes(a))return;const n=T.getChannel(t.channelId);if(n)if(n.guild_id){const d=E.getGuild(n.guild_id);c.showToast(`${o(a)} typing in ${d?.name} #${n.name}`)}else n.type===3?c.showToast(`${o(a)} typing in group`):c.showToast(`${o(a)} typing in DM`)};u.subscribe("MESSAGE_CREATE",s),u.subscribe("TYPING_START",i),p=function(){return u.unsubscribe("MESSAGE_CREATE",s)},y=function(){return u.unsubscribe("TYPING_START",i)}};var N={onLoad(){v()},onUnload(){b?.(),p?.(),y?.()},settings:{...w,applyCallback:v}};return g.default=N,Object.defineProperty(g,"__esModule",{value:!0}),g})({},vendetta.metro,vendetta.patcher,vendetta.ui.toasts,vendetta.plugin,vendetta.metro.common);
