(function(d,g,o,s,_){"use strict";function p(){return _.useProxy(o.storage),s.React.createElement(s.ReactNative.ScrollView,{style:{flex:1,backgroundColor:"#2f3136",padding:16}},s.React.createElement(s.ReactNative.Text,{style:{color:"#fff",fontSize:20,fontWeight:"bold",marginBottom:12}},"Quest Automator Logs"),s.React.createElement(s.ReactNative.View,{style:{backgroundColor:"#202225",borderRadius:8,padding:12,borderLeftWidth:4,borderLeftColor:"#7289da"}},o.storage.logs&&o.storage.logs.length>0?o.storage.logs.map(function(t,e){return s.React.createElement(s.ReactNative.View,{key:e,style:{marginBottom:6,flexDirection:"row",flexWrap:"wrap"}},s.React.createElement(s.ReactNative.Text,{style:{color:"#8e9297",fontSize:12}},"[",t.time,"]"),s.React.createElement(s.ReactNative.Text,{style:{color:t.color,fontSize:13,marginLeft:6,fontWeight:"500"}},t.message))}):s.React.createElement(s.ReactNative.Text,{style:{color:"#72767d",italic:!0}},"No activity recorded yet.")),s.React.createElement(s.ReactNative.TouchableOpacity,{onPress:function(){o.storage.logs=[]},style:{marginTop:20,backgroundColor:"#4e5d94",padding:14,borderRadius:8,alignItems:"center"}},s.React.createElement(s.ReactNative.Text,{style:{color:"#fff",fontWeight:"bold"}},"Clear Logs")))}const b=g.findByProps("getToken").getToken,u="Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) discord/1.0.9215 Chrome/138.0.7204.251 Electron/37.6.0 Safari/537.36",h={os:"Windows",browser:"Discord Client",release_channel:"stable",client_version:"1.0.9215",os_version:"10.0.19045",os_arch:"x64",app_arch:"x64",system_locale:"en-US",has_client_mods:!1,client_launch_id:"78891563-35f9-4b6d-88f2-89736f1c4630",browser_user_agent:u,browser_version:"37.6.0",os_sdk_version:"19045",client_build_number:471091,native_build_number:72186,client_event_source:null,launch_signature:"a998b156-35f9-4b6d-88f2-89736f1c4630",client_heartbeat_session_id:"b889b156-35f9-4b6d-88f2-89736f1c4630",client_app_state:"focused"},v=btoa(JSON.stringify(h));function n(t,e){const a=new Date().toLocaleTimeString();o.storage.logs=[{time:a,message:e,color:t},...o.storage.logs||[]].slice(0,50)}const l=function(t){return new Promise(function(e){return setTimeout(e,t)})};async function w(t,e=5){for(let a=0;a<e;a++)try{return await t()}catch{await l(3e3)}}async function c(t,e="GET",a){return await w(function(){return fetch(t,{method:e,headers:{Authorization:b(),"User-Agent":u,"x-super-properties":v,"Content-Type":"application/json"},body:a?JSON.stringify(a):void 0}).then(function(i){return i.json()})})}async function y(t,e){const a=t.config.messages.quest_name,i=t.config.task_config.tasks[e].target;let r=t.user_status?.progress?.[e]?.value||0;if(n("#ffff33",`${a} type: ${e}`),e.includes("WATCH_VIDEO"))for(;r<i;){const f=await c(`https://discord.com/api/v10/quests/${t.id}/video-progress`,"POST",{timestamp:Math.min(i,r+7+Math.random())});if(r+=7,n("#00ffff",`${a} ${Math.min(r,i)}/${i}`),f.completed_at)break;await l(2e3)}else{for(;;){const f=await c(`https://discord.com/api/v10/quests/${t.id}/heartbeat`,"POST",{application_id:t.config.application.id,terminal:!1});if(r=f.progress?.[e]?.value||r,n("#00ffff",`${a} ${r}/${i}`),f.completed_at)break;await l(3e4)}await c(`https://discord.com/api/v10/quests/${t.id}/heartbeat`,"POST",{application_id:t.config.application.id,terminal:!0})}n("#43b581",`${a} ${e} completed`)}async function m(t){let e=t;for(e.user_status?.enrolled_at||await c(`https://discord.com/api/v10/quests/${e.id}/enroll`,"POST",{location:11,is_targeted:!1,metadata_raw:null});e=(await c("https://discord.com/api/v10/quests/@me")).quests.find(function(a){return a.id===e.id}),!(!e||e.user_status?.completed_at);){const a=Object.keys(e.config.task_config.tasks).filter(function(i){const r=e.config.task_config.tasks[i].target;return(e.user_status?.progress?.[i]?.value||0)<r});if(!a.length)break;await y(e,a[0]),await l(3e3)}}async function R(){try{const t=await c("https://discord.com/api/v10/users/@me");n("#43b581",`Logged ${t.username}`);const e=((await c("https://discord.com/api/v10/quests/@me")).quests||[]).filter(function(a){return!a.user_status?.completed_at&&new Date(a.config.expires_at)>new Date});n("#ffff33",`Quests ${e.length}`);for(const a of e)await m(a);n("#43b581","All quests finished")}catch(t){n("#f04747",`Error: ${t.message}`)}}var T={onLoad(){o.storage.logs=[],R()},onUnload(){},settings:p};return d.default=T,Object.defineProperty(d,"__esModule",{value:!0}),d})({},vendetta.metro,vendetta.plugin,vendetta.metro.common,vendetta.storage);
