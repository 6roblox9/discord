(function(d,v,s,n){"use strict";function w(){const t=n.storage.logs||[];return s.React.createElement(s.ReactNative.ScrollView,{style:{flex:1,backgroundColor:"#2f3136",padding:16}},s.React.createElement(s.ReactNative.View,{style:{marginBottom:16}},s.React.createElement(s.ReactNative.Text,{style:{color:"#fff",fontSize:18,fontWeight:"bold"}},"Quest Auto Solver"),s.React.createElement(s.ReactNative.Text,{style:{color:"#b9bbbe",marginTop:4}},"Runs once on Discord launch")),s.React.createElement(s.ReactNative.TouchableOpacity,{onPress:function(){return n.storage.logs=[]},style:{backgroundColor:"#5865f2",padding:12,borderRadius:8,alignItems:"center",marginBottom:16}},s.React.createElement(s.ReactNative.Text,{style:{color:"#fff",fontWeight:"bold"}},"Clear Logs")),s.React.createElement(s.ReactNative.View,null,t.length===0&&s.React.createElement(s.ReactNative.Text,{style:{color:"#b9bbbe"}},"No logs"),t.map(function(a,e){return s.React.createElement(s.ReactNative.Text,{key:e,style:{color:"#fff",marginBottom:4}},a)})))}const y="Discord-Android/305012;RNA",f=function(t){return new Promise(function(a){return setTimeout(a,t)})};async function u(t,a,e="GET",o){const r=await fetch(t,{method:e,headers:{Authorization:a,"User-Agent":y,"Content-Type":"application/json"},body:o?JSON.stringify(o):void 0});if(!r.ok)throw new Error(String(r.status));return r.json()}async function g(t){return((await u("https://discord.com/api/v10/quests/@me",t)).quests||[]).filter(function(a){return!a.user_status?.completed_at&&new Date(a.config.expires_at)>new Date})}async function b(t,a){await u(`https://discord.com/api/v10/quests/${a}/enroll`,t,"POST",{location:11,is_targeted:!1,metadata_raw:null})}async function R(t,a,e){return u(`https://discord.com/api/v10/quests/${a}/video-progress`,t,"POST",{timestamp:e})}async function p(t,a,e,o){return u(`https://discord.com/api/v10/quests/${a}/heartbeat`,t,"POST",{application_id:e,terminal:o})}async function _(t,a){for(a.user_status?.enrolled_at||await b(t,a.id);;){const e=(await g(t)).find(function(i){return i.id===a.id});if(!e||e.user_status?.completed_at)break;const o=Object.keys(e.config.task_config.tasks).filter(function(i){const m=e.config.task_config.tasks[i].target;return(e.user_status?.progress?.[i]?.value||0)<m});if(!o.length)break;const r=o[0],h=e.config.task_config.tasks[r].target;let l=e.user_status?.progress?.[r]?.value||0;if(r.includes("WATCH_VIDEO"))for(;l<h;)await R(t,e.id,Math.min(h,l+6+Math.random()*4)),l+=6,await f(2e3+Math.random()*2e3);else{for(;;){const i=await p(t,e.id,e.config.application.id,!1);if(l=i.progress?.[r]?.value||l,i.completed_at)break;await f(25e3+Math.random()*1e4)}await p(t,e.id,e.config.application.id,!0)}}}async function k(t){n.storage.logs=[];const a=await g(t);if(!a.length)return!1;for(const e of a)await _(t,e),await f(3e3);return!0}const T=v.findByProps("getToken").getToken;let c=!1;async function N(){if(c)return;c=!0,n.storage.logs=[],n.storage.logs.push("Plugin loaded");const t=T();if(!t){n.storage.logs.push("Failed to get token"),c=!1;return}n.storage.logs.push("Token acquired"),await k(t)?n.storage.logs.push("All quests completed"):n.storage.logs.push("No quests available"),c=!1}var E={onLoad(){N()},onUnload(){c=!1},settings:w};return d.default=E,Object.defineProperty(d,"__esModule",{value:!0}),d})({},vendetta.metro,vendetta.metro.common,vendetta.plugin);
