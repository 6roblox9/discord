(function(g,p,c,s,w){"use strict";function h(){w.useProxy(c.storage);const t=c.storage.logs||[];return s.React.createElement(s.ReactNative.View,{style:{flex:1,backgroundColor:"#202225"}},s.React.createElement(s.ReactNative.View,{style:{padding:16,borderBottomWidth:1,borderBottomColor:"#2f3136"}},s.React.createElement(s.ReactNative.Text,{style:{color:"#fff",fontSize:20,fontWeight:"bold"}},"Quest Logs")),s.React.createElement(s.ReactNative.ScrollView,{style:{flex:1,padding:12}},t.length===0?s.React.createElement(s.ReactNative.Text,{style:{color:"#8e9297",textAlign:"center",marginTop:20}},"Waiting for tasks..."):t.map(function(e,a){return s.React.createElement(s.ReactNative.View,{key:a,style:{marginBottom:6,flexDirection:"row"}},s.React.createElement(s.ReactNative.Text,{style:{color:"#72767d",fontSize:11,width:80}},"[",e.time,"]"),s.React.createElement(s.ReactNative.Text,{style:{color:e.color,fontWeight:"500",flex:1}},e.message))})),s.React.createElement(s.ReactNative.TouchableOpacity,{onPress:function(){c.storage.logs=[]},style:{backgroundColor:"#f04747",margin:16,padding:12,borderRadius:8,alignItems:"center"}},s.React.createElement(s.ReactNative.Text,{style:{color:"#fff",fontWeight:"bold"}},"Clear Logs")))}const y=p.findByProps("getToken").getToken,_={os:"Windows",browser:"Discord Client",release_channel:"stable",client_version:"1.0.9215",os_version:"10.0.19045",os_arch:"x64",app_arch:"x64",system_locale:"en-US",has_client_mods:!1,client_launch_id:Math.random().toString(36),browser_user_agent:"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) discord/1.0.9215 Chrome/138.0.7204.251 Electron/37.6.0 Safari/537.36",browser_version:"37.6.0",os_sdk_version:"19045",client_build_number:471091,native_build_number:72186,client_event_source:null,launch_signature:Math.random().toString(36),client_heartbeat_session_id:Math.random().toString(36),client_app_state:"focused"},b=btoa(JSON.stringify(_));function n(t,e){const a=new Date().toLocaleTimeString();c.storage.logs||(c.storage.logs=[]),c.storage.logs.push({time:a,color:t,message:e})}const u=function(t){return new Promise(function(e){return setTimeout(e,t)})};async function m(t,e=5){for(let a=0;a<e;a++)try{return await t()}catch{await u(3e3)}}async function l(t,e="GET",a){const o=y();return(await m(function(){return fetch(`https://discord.com/api/v10${t}`,{method:e,headers:{Authorization:o,"Content-Type":"application/json","x-super-properties":b,"User-Agent":_.browser_user_agent},body:a?JSON.stringify(a):void 0})})).json()}async function v(t){return((await l("/quests/@me")).quests||[]).find(function(e){return e.id===t})}async function $(t,e){const a=t.config.messages.quest_name,o=t.id,i=t.config.task_config.tasks[e].target;let r=t.user_status?.progress?.[e]?.value||0,f=0;if(n("#faa81a",`${a} type: ${e}`),e.includes("WATCH_VIDEO"))for(;r<i;){const d=await l(`/quests/${o}/video-progress`,"POST",{timestamp:Math.min(i,r+7+Math.random())});if(r+=7,Date.now()-f>=1e4&&(n("#00bfff",`${a} ${Math.min(r,i)}/${i} remaining ${Math.max(0,i-r)}`),f=Date.now()),d.completed_at)break;await u(2e3)}else{for(;;){const d=await l(`/quests/${o}/heartbeat`,"POST",{application_id:t.config.application.id,terminal:!1});if(r=d.progress?.[e]?.value||r,Date.now()-f>=1e4&&(n("#00bfff",`${a} ${r}/${i} remaining ${Math.max(0,i-r)}`),f=Date.now()),d.completed_at)break;await u(3e4)}await l(`/quests/${o}/heartbeat`,"POST",{application_id:t.config.application.id,terminal:!0})}n("#36e333",`${a} ${e} completed`)}async function R(t){let e=t;for(e.user_status?.enrolled_at||await l(`/quests/${e.id}/enroll`,"POST",{location:11,is_targeted:!1,metadata_raw:null});e=await v(e.id),!(!e||e.user_status?.completed_at);){const a=Object.keys(e.config.task_config.tasks).filter(function(o){const i=e.config.task_config.tasks[o].target;return(e.user_status?.progress?.[o]?.value||0)<i});if(!a.length)break;await $(e,a[0]),await u(3e3)}n("#36e333",`${e.config.messages.quest_name} fully completed`)}async function T(){c.storage.logs=[];try{const t=await l("/users/@me");n("#36e333",`Logged ${t.username}#${t.discriminator}`);const e=((await l("/quests/@me")).quests||[]).filter(function(a){return!a.user_status?.completed_at&&new Date(a.config.expires_at)>new Date});n("#faa81a",`Quests found: ${e.length}`);for(const a of e)await R(a);n("#36e333","All quests finished")}catch(t){n("#ff4747",`Error: ${t.message}`)}}var k={onLoad(){T()},onUnload(){},settings:h};return g.default=k,Object.defineProperty(g,"__esModule",{value:!0}),g})({},vendetta.metro,vendetta.plugin,vendetta.metro.common,vendetta.storage);
