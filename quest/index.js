(function(h,c,y,a){"use strict";const{getToken:$}=y.findByProps("getToken");c.storage.logs=[];const e=function(u){const t=`[${new Date().toLocaleTimeString()}] ${u}`;c.storage.logs||(c.storage.logs=[]),c.storage.logs.unshift(t),c.storage.logs.length>50&&c.storage.logs.pop(),console.log(t)};async function w(u){try{const t=await fetch("https://discord.com/api/v10/quests/@me",{headers:{Authorization:u,"User-Agent":"Discord-Android/305012;RNA"}});return t.ok?await t.json():(a.showToast(`\u062E\u0637\u0623: ${t.status}`),null)}catch{return a.showToast("\u062E\u0637\u0623 \u0641\u064A \u0627\u0644\u0627\u062A\u0635\u0627\u0644"),null}}async function _(u,t){try{await fetch(`https://discord.com/api/v10/quests/${t}/enroll`,{method:"POST",headers:{Authorization:u,"User-Agent":"Discord-Android/305012;RNA","Content-Type":"application/json"},body:JSON.stringify({location:11,is_targeted:!1})})}catch{}}async function C(u,t,o){try{return(await fetch(`https://discord.com/api/v10/quests/${t}/video-progress`,{method:"POST",headers:{Authorization:u,"User-Agent":"Discord-Android/305012;RNA","Content-Type":"application/json"},body:JSON.stringify({timestamp:o})})).json()}catch{return null}}async function p(u,t,o,n){try{return(await fetch(`https://discord.com/api/v10/quests/${t}/heartbeat`,{method:"POST",headers:{Authorization:u,"User-Agent":"Discord-Android/305012;RNA","Content-Type":"application/json"},body:JSON.stringify({application_id:o,terminal:n})})).json()}catch{return null}}async function v(u,t){const o=t.config.messages.quest_name,n=t.id;e(`\u062C\u0627\u0631\u064A \u0645\u0639\u0627\u0644\u062C\u0629: ${o}`),a.showToast(`\u0628\u062F\u0623 \u0627\u0644\u0643\u0648\u064A\u0633\u062A: ${o}`),t.user_status?.enrolled_at||(await _(u,n),await new Promise(function(i){return setTimeout(i,2e3)}));const s=(await w(u))?.quests?.find(function(i){return i.id===n});if(!s||s.user_status?.completed_at){e(`\u0627\u0643\u062A\u0645\u0644: ${o}`);return}const d=s.config.task_config.tasks;for(let i=0;i<d.length;i++){const T=d[i],m=Object.keys(T)[0],A=T[m].target,l=s.user_status?.progress?.[i]?.value||0;if(!(l>=A))if(e(`\u0645\u0647\u0645\u0629 ${i+1}: ${m} (${l}/${A})`),m.includes("WATCH_VIDEO")){let r=l;for(;r<A;){const f=Math.min(A,r+5);await C(u,n,f),r=f,e(`\u0641\u064A\u062F\u064A\u0648: ${r}/${A}`),await new Promise(function(P){return setTimeout(P,1e3)})}}else{for(let r=l;r<A;r++)await p(u,n,s.config.application.id,!1),e(`\u0646\u0634\u0627\u0637: ${r+1}/${A}`),await new Promise(function(f){return setTimeout(f,1e4)});await p(u,n,s.config.application.id,!0)}}e(`\u062A\u0645 \u0625\u0643\u0645\u0627\u0644: ${o}`),a.showToast(`\u062A\u0645 \u0627\u0644\u0643\u0648\u064A\u0633\u062A: ${o}`)}async function D(){try{e("\u0628\u062F\u0621 \u0627\u0644\u0628\u062D\u062B \u0639\u0646 \u0627\u0644\u0643\u0648\u064A\u0633\u062A\u0627\u062A...");const u=$();if(!u){e("\u0644\u0627 \u064A\u0648\u062C\u062F \u062A\u0648\u0643\u0646"),a.showToast("\u062E\u0637\u0623 \u0641\u064A \u0627\u0644\u062A\u0648\u0643\u0646");return}const t=await w(u);if(!t?.quests){e("\u0644\u0627 \u062A\u0648\u062C\u062F \u0628\u064A\u0627\u0646\u0627\u062A \u0643\u0648\u064A\u0633\u062A\u0627\u062A");return}const o=new Date,n=t.quests.filter(function(s){const d=s.user_status?.completed_at,i=new Date(s.config.expires_at)<=o;return!d&&!i});if(n.length===0){e("\u0644\u0627 \u062A\u0648\u062C\u062F \u0643\u0648\u064A\u0633\u062A\u0627\u062A \u0645\u062A\u0627\u062D\u0629"),a.showToast("\u0644\u0627 \u062A\u0648\u062C\u062F \u0643\u0648\u064A\u0633\u062A\u0627\u062A");return}e(`\u0648\u062C\u062F ${n.length} \u0643\u0648\u064A\u0633\u062A`),a.showToast(`\u0648\u062C\u062F ${n.length} \u0643\u0648\u064A\u0633\u062A`);for(const s of n)await v(u,s),await new Promise(function(d){return setTimeout(d,3e3)});e("\u062A\u0645 \u0625\u0643\u0645\u0627\u0644 \u062C\u0645\u064A\u0639 \u0627\u0644\u0643\u0648\u064A\u0633\u062A\u0627\u062A"),a.showToast("\u062A\u0645 \u0625\u0643\u0645\u0627\u0644 \u062C\u0645\u064A\u0639 \u0627\u0644\u0643\u0648\u064A\u0633\u062A\u0627\u062A!")}catch(u){e(`\u062E\u0637\u0623: ${u.message}`)}}let g;var q={onLoad(){e("\u062A\u0645 \u062A\u062D\u0645\u064A\u0644 \u0628\u0644\u0648\u0642\u0646 \u0627\u0644\u0643\u0648\u064A\u0633\u062A\u0627\u062A"),a.showToast("\u0628\u0644\u0648\u0642\u0646 \u0627\u0644\u0643\u0648\u064A\u0633\u062A\u0627\u062A \u062C\u0627\u0647\u0632"),g=setTimeout(function(){D()},5e3)},onUnload(){e("\u0625\u064A\u0642\u0627\u0641 \u0628\u0644\u0648\u0642\u0646 \u0627\u0644\u0643\u0648\u064A\u0633\u062A\u0627\u062A"),g&&clearTimeout(g),c.storage.logs=[]},settings:function(){const{React:u}=require("@vendetta/metro/common"),{default:t}=require("./settings");return u.createElement(t)}};return h.default=q,Object.defineProperty(h,"__esModule",{value:!0}),h})({},vendetta.plugin,vendetta.metro,vendetta.ui.toasts);
