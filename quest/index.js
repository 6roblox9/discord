(function(d,h,o,s){"use strict";function w(){const t=s.storage.logs||[];return o.React.createElement(o.ReactNative.ScrollView,{style:{flex:1,backgroundColor:"#2f3136",padding:16}},o.React.createElement(o.ReactNative.Text,{style:{color:"#fff",fontSize:18,fontWeight:"bold",marginBottom:12}},"Quest Auto Solver"),o.React.createElement(o.ReactNative.TouchableOpacity,{onPress:function(){return s.storage.logs=[]},style:{backgroundColor:"#5865f2",padding:12,borderRadius:8,alignItems:"center",marginBottom:16}},o.React.createElement(o.ReactNative.Text,{style:{color:"#fff",fontWeight:"bold"}},"Clear Logs")),t.length===0&&o.React.createElement(o.ReactNative.Text,{style:{color:"#b9bbbe"}},"No logs"),t.map(function(e,a){return o.React.createElement(o.ReactNative.Text,{key:a,style:{color:"#fff",marginBottom:4}},e)}))}const v="Discord-Android/305012;RNA",f=function(t){return new Promise(function(e){return setTimeout(e,t)})};async function l(t,e,a="GET",n){const i=await fetch(t,{method:a,headers:{Authorization:e,"User-Agent":v,"Content-Type":"application/json"},body:n?JSON.stringify(n):void 0});if(!i.ok)throw new Error(String(i.status));return i.json()}async function g(t){return((await l("https://discord.com/api/v10/quests/@me",t)).quests||[]).filter(function(e){return!e.user_status?.completed_at&&new Date(e.config.expires_at)>new Date})}async function y(t,e){await l(`https://discord.com/api/v10/quests/${e}/enroll`,t,"POST",{location:11,is_targeted:!1,metadata_raw:null})}async function _(t,e,a){await l(`https://discord.com/api/v10/quests/${e}/video-progress`,t,"POST",{timestamp:a})}async function p(t,e,a,n){return l(`https://discord.com/api/v10/quests/${e}/heartbeat`,t,"POST",{application_id:a,terminal:n})}async function k(t,e){for(s.storage.logs.push(`Quest: ${e.config.messages.quest_name}`),e.user_status?.enrolled_at||(await y(t,e.id),s.storage.logs.push("Enrolled"));;){const a=(await g(t)).find(function(r){return r.id===e.id});if(!a||a.user_status?.completed_at)break;const n=Object.keys(a.config.task_config.tasks).find(function(r){const q=a.config.task_config.tasks[r].target;return(a.user_status?.progress?.[r]?.value||0)<q});if(!n)break;const i=a.config.task_config.tasks[n].target;let u=a.user_status?.progress?.[n]?.value||0;if(s.storage.logs.push(`Task: ${n}`),n.includes("WATCH_VIDEO"))for(;u<i;)await _(t,a.id,Math.min(i,u+6)),u+=6,await f(2e3+Math.random()*2e3);else{for(;;){const r=await p(t,a.id,a.config.application.id,!1);if(u=r.progress?.[n]?.value||u,r.completed_at)break;await f(25e3+Math.random()*1e4)}await p(t,a.id,a.config.application.id,!0)}}s.storage.logs.push("Quest completed")}async function m(t){const e=await g(t);if(s.storage.logs.push(`Found ${e.length} quests`),!e.length)return!1;for(const a of e)await k(t,a),await f(3e3);return!0}const b=h.findByProps("getToken").getToken;let c=!1;async function T(){if(c)return;c=!0,s.storage.logs=[],s.storage.logs.push("Plugin loaded");const t=b();if(!t){s.storage.logs.push("Failed to get token"),c=!1;return}s.storage.logs.push("Token acquired"),await m(t)?s.storage.logs.push("All quests completed"):s.storage.logs.push("No quests available"),c=!1}var R={onLoad(){T()},onUnload(){c=!1},settings:w};return d.default=R,Object.defineProperty(d,"__esModule",{value:!0}),d})({},vendetta.metro,vendetta.metro.common,vendetta.plugin);
