(function(r,l,u){"use strict";const g=l.findByProps("getToken").getToken;let o=!1;const p="Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) discord/1.0.9215 Chrome/138.0.7204.251 Electron/37.6.0 Safari/537.36",m={os:"Windows",browser:"Discord Client",release_channel:"stable",client_version:"1.0.9215"},c=function(e){return new Promise(function(t){return setTimeout(t,e)})},w=function(){return new Date().toLocaleTimeString()};function i(e,t){u.storage.logs.push(`[${w()}] ${t}`)}async function a(e,t="GET",s){const n=g();if(!n)throw new Error("No token");return(await fetch(e,{method:t,headers:{Authorization:n,"User-Agent":p,"x-super-properties":btoa(JSON.stringify(m)),"Content-Type":"application/json"},body:s?JSON.stringify(s):void 0})).json()}async function f(){return a("https://discord.com/api/v10/quests/@me")}async function _(e){await a(`https://discord.com/api/v10/quests/${e}/enroll`,"POST",{location:11,is_targeted:!1,metadata_raw:null})}async function h(e,t){return a(`https://discord.com/api/v10/quests/${e}/video-progress`,"POST",{timestamp:t})}async function d(e,t,s){return a(`https://discord.com/api/v10/quests/${e}/heartbeat`,"POST",{application_id:t,terminal:s})}async function y(e,t){const s=e.config.task_config.tasks[t].target;let n=e.user_status?.progress?.[t]?.value||0;if(i("Y",`${e.config.messages.quest_name} ${t}`),t.includes("WATCH_VIDEO"))for(;n<s;)await h(e.id,Math.min(s,n+7)),n+=7,i("C",`${n}/${s}`),await c(2e3);else{for(;n<s;)n=(await d(e.id,e.config.application.id,!1)).progress?.[t]?.value||n,i("C",`${n}/${s}`),await c(3e4);await d(e.id,e.config.application.id,!0)}i("G",`${t} completed`)}async function k(e){for(e.user_status?.enrolled_at||await _(e.id);;){const t=(await f()).quests.find(function(n){return n.id===e.id});if(!t||t.user_status?.completed_at)break;const s=Object.keys(t.config.task_config.tasks).filter(function(n){const T=t.config.task_config.tasks[n].target;return(t.user_status?.progress?.[n]?.value||0)<T});if(!s.length)break;await y(t,s[0]),await c(3e3)}i("G",`${e.config.messages.quest_name} done`)}async function v(){if(o)return;o=!0,u.storage.logs=[];const e=((await f()).quests||[]).filter(function(t){return!t.user_status?.completed_at&&new Date(t.config.expires_at)>new Date});if(!e.length){i("X","No quests"),o=!1;return}for(const t of e)await k(t);i("G","All quests finished"),o=!1}var $={onLoad(){v()},onUnload(){o=!1}};return r.default=$,Object.defineProperty(r,"__esModule",{value:!0}),r})({},vendetta.metro,vendetta.plugin);
