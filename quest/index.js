(function(w,R,r){"use strict";const _=[];let g=[];function k(e){return g.push(e),function(){g=g.filter(function(t){return t!==e})}}function i(e,t){const a=new Date().toLocaleTimeString();_.push({id:Math.random().toString(36).substring(7),color:e,text:t,time:a}),g.forEach(function(n){return n()})}function T(){_.length=0,g.forEach(function(e){return e()})}function S(){const[e,t]=r.React.useReducer(function(n){return n+1},0);r.React.useEffect(function(){return k(function(){return t()})},[]);const a=function(n){switch(n){case"G":return"#43b581";case"Y":return"#faa61a";case"C":return"#00b0f4";default:return"#dcddde"}};return r.React.createElement(r.ReactNative.ScrollView,{style:{flex:1,backgroundColor:"#202225",padding:12}},r.React.createElement(r.ReactNative.View,{style:{marginBottom:16}},r.React.createElement(r.ReactNative.Text,{style:{color:"#fff",fontSize:18,fontWeight:"bold",marginBottom:8}},"Quest Auto-Solver Logs")),r.React.createElement(r.ReactNative.View,{style:{backgroundColor:"#2f3136",borderRadius:8,padding:12,minHeight:200}},_.length===0?r.React.createElement(r.ReactNative.Text,{style:{color:"#72767d",fontStyle:"italic",textAlign:"center",marginTop:20}},"Waiting for activity..."):_.map(function(n){return r.React.createElement(r.ReactNative.Text,{key:n.id,style:{fontFamily:"monospace",fontSize:12,marginBottom:2}},r.React.createElement(r.ReactNative.Text,{style:{color:"#72767d"}},"[",n.time,"] "),r.React.createElement(r.ReactNative.Text,{style:{color:a(n.color)}},n.text))})),r.React.createElement(r.ReactNative.View,{style:{height:20}}))}const{getToken:y}=R.findByProps("getToken");let c=!1;const v="Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) discord/1.0.9215 Chrome/138.0.7204.251 Electron/37.6.0 Safari/537.36",E={os:"Windows",browser:"Discord Client",release_channel:"stable",client_version:"1.0.9215",os_version:"10.0.19045",os_arch:"x64",app_arch:"x64",system_locale:"en-US",has_client_mods:!1,client_launch_id:"80933496-6512-4217-86e5-42289632435f",browser_user_agent:v,browser_version:"37.6.0",os_sdk_version:"19045",client_build_number:471091,native_build_number:72186,client_event_source:null,launch_signature:"80933496-6512-4217-86e5-42289632435f",client_heartbeat_session_id:"80933496-6512-4217-86e5-42289632435f",client_app_state:"focused"},f=function(e){return new Promise(function(t){return setTimeout(t,e)})};function $(e){const t=JSON.stringify(e),a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";let n="";for(let s=0,o,u=0,l=a;t.charAt(u|0)||(l="=",u%1);n+=l.charAt(63&s>>8-u%1*8))o=t.charCodeAt(u+=3/4),s=s<<8|o;return n}function h(){return{Authorization:y(),"User-Agent":v,"x-super-properties":$(E),"Content-Type":"application/json"}}async function p(e,t=5){for(let a=0;a<t;a++){if(c)return null;try{return await e()}catch{await f(3e3)}}return null}async function b(){const e=await p(function(){return fetch("https://discord.com/api/v9/quests/@me",{headers:h()})});return e?e.json():{quests:[]}}async function N(e){await p(function(){return fetch(`https://discord.com/api/v9/quests/${e}/enroll`,{method:"POST",headers:h(),body:JSON.stringify({location:11,is_targeted:!1,metadata_raw:null})})})}async function q(e,t){const a=await p(function(){return fetch(`https://discord.com/api/v9/quests/${e}/video-progress`,{method:"POST",headers:h(),body:JSON.stringify({timestamp:t})})});return a?a.json():{}}async function m(e,t,a){const n=await p(function(){return fetch(`https://discord.com/api/v9/quests/${e}/heartbeat`,{method:"POST",headers:h(),body:JSON.stringify({application_id:t,terminal:a})})});return n?n.json():{}}async function x(e){return((await b()).quests||[]).find(function(t){return t.id===e})}async function A(e,t){if(c)return;const a=e.config.messages.quest_name,n=e.id,s=e.config.task_config.tasks[t].target;let o=e.user_status?.progress?.[t]?.value||0,u=0;if(i("Y",`${a} type: ${t}`),t.includes("WATCH_VIDEO"))for(;o<s&&!c;){const l=Math.min(s,o+7+Math.random()),d=await q(n,l);if(o=l,Date.now()-u>=1e4&&(i("C",`${a} ${Math.min(o,s).toFixed(0)}/${s}`),u=Date.now()),d.completed_at||d.user_status&&d.user_status.completed_at)break;await f(2e3)}else{for(;!c;){const l=await m(n,e.config.application.id,!1),d=l.user_status||l;if(o=d.progress?.[t]?.value||o,Date.now()-u>=1e4&&(i("C",`${a} ${o}/${s}`),u=Date.now()),d.completed_at)break;await f(3e4)}c||await m(n,e.config.application.id,!0)}i("G",`${a} ${t} completed`)}async function C(e){let t=e;for(t.user_status?.enrolled_at||(i("Y",`Enrolling in ${t.config.messages.quest_name}...`),await N(t.id),await f(2e3));!(c||(t=await x(t.id),!t||t.user_status?.completed_at));){const a=Object.keys(t.config.task_config.tasks).filter(function(n){const s=t.config.task_config.tasks[n].target;return(t.user_status?.progress?.[n]?.value||0)<s});if(a.length===0)break;await A(t,a[0]),await f(3e3)}i("G",`${t.config.messages.quest_name} fully finished`)}async function O(){if(!y()){i("X","Error: No Token");return}i("Y","Fetching quests...");try{const e=((await b()).quests||[]).filter(function(t){return!t.user_status?.completed_at&&new Date(t.config.expires_at)>new Date});i("Y",`Active quests to process: ${e.length}`);for(const t of e){if(c)break;await C(t),await f(5e3)}i("G","All available quests have been processed.")}catch(e){i("X",`Error: ${e.message}`)}}var D={onLoad:function(){c=!1,T(),i("C","Auto Quest Started"),O()},onUnload:function(){c=!0},settings:S};return w.default=D,Object.defineProperty(w,"__esModule",{value:!0}),w})({},vendetta.metro,vendetta.metro.common);
