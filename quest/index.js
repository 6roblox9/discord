(function(g,p,a){"use strict";const u=[];let c=[];function v(e){return c.push(e),function(){c=c.filter(function(t){return t!==e})}}function i(e,t){const s=new Date().toLocaleTimeString();u.push({id:Math.random().toString(36).substring(7),color:e,text:t,time:s}),c.forEach(function(n){return n()})}function w(){u.length=0,c.forEach(function(e){return e()})}function _(){const[e,t]=a.React.useReducer(function(n){return n+1},0);a.React.useEffect(function(){return v(function(){return t()})},[]);const s=function(n){switch(n){case"G":return"#43b581";case"Y":return"#faa61a";case"C":return"#00b0f4";case"R":return"#f04747";default:return"#dcddde"}};return a.React.createElement(a.ReactNative.ScrollView,{style:{flex:1,backgroundColor:"#202225",padding:12}},a.React.createElement(a.ReactNative.View,{style:{marginBottom:16}},a.React.createElement(a.ReactNative.Text,{style:{color:"#fff",fontSize:18,fontWeight:"bold",marginBottom:8}},"Quest Auto-Solver Logs")),a.React.createElement(a.ReactNative.View,{style:{backgroundColor:"#2f3136",borderRadius:8,padding:12,minHeight:200}},u.length===0?a.React.createElement(a.ReactNative.Text,{style:{color:"#72767d",fontStyle:"italic",textAlign:"center",marginTop:20}},"Waiting for activity..."):u.map(function(n){return a.React.createElement(a.ReactNative.Text,{key:n.id,style:{fontFamily:"monospace",fontSize:12,marginBottom:2}},a.React.createElement(a.ReactNative.Text,{style:{color:"#72767d"}},"[",n.time,"] "),a.React.createElement(a.ReactNative.Text,{style:{color:s(n.color)}},n.text))})),a.React.createElement(a.ReactNative.View,{style:{height:20}}))}const{getToken:h}=p.findByProps("getToken"),{getSuperPropertiesBase64:S}=p.findByProps("getSuperPropertiesBase64");let o=!1;const f=function(e){return new Promise(function(t){return setTimeout(t,e)})};function l(){return{Authorization:h(),"x-super-properties":S(),"Content-Type":"application/json"}}async function y(){return(await fetch("https://discord.com/api/v9/quests/@me",{headers:l()})).json()}async function k(e){await fetch(`https://discord.com/api/v9/quests/${e}/enroll`,{method:"POST",headers:l(),body:JSON.stringify({location:11})})}async function T(e,t){return(await fetch(`https://discord.com/api/v9/quests/${e}/video-progress`,{method:"POST",headers:l(),body:JSON.stringify({timestamp:t})})).json()}async function R(e,t,s){return(await fetch(`https://discord.com/api/v9/quests/${e}/heartbeat`,{method:"POST",headers:l(),body:JSON.stringify({application_id:t,terminal:s})})).json()}async function b(e,t){if(o)return;const s=e.config.messages.quest_name,n=e.config.task_config.tasks[t].target;let r=e.user_status?.progress?.[t]?.value||0;if(i("Y",`Starting ${s} [${t}]`),i("C",`Progress: ${r}/${n}`),t.includes("WATCH_VIDEO")||t==="QUEST_TASK_WATCH_VIDEO")for(;r<n;){if(o)return;const d=7+Math.random(),N=Math.min(n,r+d),P=await T(e.id,N);if(r+=7,i("C",`Watching... ${Math.min(r,n).toFixed(0)}/${n}`),P.user_status?.completed_at)break;await f(2e3)}else{for(;r<n;){if(o)return;const d=await R(e.id,e.config.application.id,!1);if(r=d.user_status?.progress?.[t]?.value||r,i("C",`Playing... ${r}/${n}`),d.user_status?.completed_at)break;await f(3e4)}await R(e.id,e.config.application.id,!0)}i("G",`Task ${t} Completed!`)}async function E(e){let t=e;i("G",`Found Quest: ${t.config.messages.quest_name}`),t.user_status?.enrolled_at||(i("Y","Enrolling..."),await k(t.id),await f(1e3),t=(await y()).quests.find(function(n){return n.id===t.id}));const s=Object.keys(t.config.task_config.tasks);for(const n of s){if(o)break;const r=t.config.task_config.tasks[n].target;(t.user_status?.progress?.[n]?.value||0)<r&&(await b(t,n),await f(2e3))}i("G",`Quest ${t.config.messages.quest_name} Done.`)}async function $(){if(!h()){i("R","Error: No Token found.");return}i("Y","Checking for Quests...");try{const e=((await y()).quests||[]).filter(function(t){return!t.user_status?.completed_at&&new Date(t.config.expires_at)>new Date});if(e.length===0){i("X","No active quests found. Stopping.");return}i("Y",`Found ${e.length} active quests.`);for(const t of e){if(o)break;await E(t)}i("G","All operations finished.")}catch(e){i("R",`Error: ${e.message}`)}}var m={onLoad:function(){o=!1,w(),i("C","Auto Quest Plugin Started"),$()},onUnload:function(){o=!0,i("R","Plugin Unloaded.")},settings:_};return g.default=m,Object.defineProperty(g,"__esModule",{value:!0}),g})({},vendetta.metro,vendetta.metro.common);
