(function(d,h,s,o){"use strict";function v(){const t=o.storage.logs||[];return s.React.createElement(s.ReactNative.ScrollView,{style:{flex:1,backgroundColor:"#2f3136",padding:16}},s.React.createElement(s.ReactNative.View,{style:{marginBottom:16}},s.React.createElement(s.ReactNative.Text,{style:{color:"#fff",fontSize:18,fontWeight:"bold"}},"Quest Auto Solver"),s.React.createElement(s.ReactNative.Text,{style:{color:"#b9bbbe",marginTop:4}},"Runs once on Discord launch")),s.React.createElement(s.ReactNative.TouchableOpacity,{onPress:function(){return o.storage.logs=[]},style:{backgroundColor:"#5865f2",padding:12,borderRadius:8,alignItems:"center",marginBottom:16}},s.React.createElement(s.ReactNative.Text,{style:{color:"#fff",fontWeight:"bold"}},"Clear Logs")),s.React.createElement(s.ReactNative.View,null,t.length===0&&s.React.createElement(s.ReactNative.Text,{style:{color:"#b9bbbe"}},"No logs"),t.map(function(e,a){return s.React.createElement(s.ReactNative.Text,{key:a,style:{color:"#fff",marginBottom:4}},e)})))}const w="Discord-Android/305012;RNA",f=function(t){return new Promise(function(e){return setTimeout(e,t)})};async function u(t,e,a="GET",r){const i=await fetch(t,{method:a,headers:{Authorization:e,"User-Agent":w,"Content-Type":"application/json"},body:r?JSON.stringify(r):void 0});if(!i.ok)throw new Error(String(i.status));return i.json()}async function g(t){return((await u("https://discord.com/api/v10/quests/@me",t)).quests||[]).filter(function(e){return!e.user_status?.completed_at&&new Date(e.config.expires_at)>new Date})}async function y(t,e){await u(`https://discord.com/api/v10/quests/${e}/enroll`,t,"POST",{location:11,is_targeted:!1,metadata_raw:null})}async function b(t,e,a){await u(`https://discord.com/api/v10/quests/${e}/video-progress`,t,"POST",{timestamp:a})}async function p(t,e,a,r){return u(`https://discord.com/api/v10/quests/${e}/heartbeat`,t,"POST",{application_id:a,terminal:r})}async function R(t,e){for(o.storage.logs.push(`Quest: ${e.config.messages.quest_name}`),e.user_status?.enrolled_at||(await y(t,e.id),o.storage.logs.push("Enrolled"));;){const a=(await g(t)).find(function(n){return n.id===e.id});if(!a||a.user_status?.completed_at)break;const r=Object.keys(a.config.task_config.tasks).find(function(n){const N=a.config.task_config.tasks[n].target;return(a.user_status?.progress?.[n]?.value||0)<N});if(!r)break;const i=a.config.task_config.tasks[r].target;let l=a.user_status?.progress?.[r]?.value||0;if(o.storage.logs.push(`Task: ${r}`),r.includes("WATCH_VIDEO"))for(;l<i;)await b(t,a.id,Math.min(i,l+6)),l+=6,await f(2e3+Math.random()*2e3);else{for(;;){const n=await p(t,a.id,a.config.application.id,!1);if(l=n.progress?.[r]?.value||l,n.completed_at)break;await f(25e3+Math.random()*1e4)}await p(t,a.id,a.config.application.id,!0)}}o.storage.logs.push("Quest completed")}async function _(t){const e=await g(t);if(o.storage.logs.push(`Found ${e.length} quests`),!e.length)return!1;for(const a of e)await R(t,a),await f(3e3);return!0}const k=h.findByProps("getToken").getToken;let c=!1;async function T(){if(c)return;c=!0,o.storage.logs=[],o.storage.logs.push("Plugin loaded");const t=k();if(!t){o.storage.logs.push("Failed to get token"),c=!1;return}o.storage.logs.push("Token acquired"),await _(t)?o.storage.logs.push("All quests completed"):o.storage.logs.push("No quests available"),c=!1}var E={onLoad(){T()},onUnload(){c=!1},settings:v};return d.default=E,Object.defineProperty(d,"__esModule",{value:!0}),d})({},vendetta.metro,vendetta.metro.common,vendetta.plugin);
