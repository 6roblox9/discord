(function(l,d,o,g){"use strict";function v(){const e=g.storage.logs||[];return o.React.createElement(o.ReactNative.ScrollView,{style:{flex:1,backgroundColor:"#2f3136",padding:16}},o.React.createElement(o.ReactNative.Text,{style:{color:"#fff",fontSize:18,fontWeight:"bold",marginBottom:12}},"Quest Auto Solver"),o.React.createElement(o.ReactNative.TouchableOpacity,{onPress:function(){return g.storage.logs=[]},style:{backgroundColor:"#5865f2",padding:12,borderRadius:8,alignItems:"center",marginBottom:16}},o.React.createElement(o.ReactNative.Text,{style:{color:"#fff",fontWeight:"bold"}},"Clear Logs")),e.length===0&&o.React.createElement(o.ReactNative.Text,{style:{color:"#b9bbbe"}},"No logs"),e.map(function(t,i){return o.React.createElement(o.ReactNative.Text,{key:i,style:{color:"#fff",marginBottom:4}},t)}))}const p=[];let h=[];function n(e,t){const i=new Date().toLocaleTimeString();p.push({id:Math.random().toString(36).substring(7),color:e,text:t,time:i}),h.forEach(function(a){return a()})}function b(){p.length=0,h.forEach(function(e){return e()})}const{getToken:y}=d.findByProps("getToken"),{getSuperPropertiesBase64:w}=d.findByProps("getSuperPropertiesBase64");let r=!1;const c=function(e){return new Promise(function(t){return setTimeout(t,e)})};function u(){return{Authorization:y(),"x-super-properties":w(),"Content-Type":"application/json"}}async function m(){return(await fetch("https://discord.com/api/v9/quests/@me",{headers:u()})).json()}async function k(e){await fetch(`https://discord.com/api/v9/quests/${e}/enroll`,{method:"POST",headers:u(),body:JSON.stringify({location:11})})}async function S(e,t){return(await fetch(`https://discord.com/api/v9/quests/${e}/video-progress`,{method:"POST",headers:u(),body:JSON.stringify({timestamp:t})})).json()}async function _(e,t,i){return(await fetch(`https://discord.com/api/v9/quests/${e}/heartbeat`,{method:"POST",headers:u(),body:JSON.stringify({application_id:t,terminal:i})})).json()}async function T(e,t){if(r)return;const i=e.config.messages.quest_name,a=e.config.task_config.tasks[t].target;let s=e.user_status?.progress?.[t]?.value||0;if(n("Y",`Starting ${i} [${t}]`),n("C",`Progress: ${s}/${a}`),t.includes("WATCH_VIDEO")||t==="QUEST_TASK_WATCH_VIDEO")for(;s<a;){if(r)return;const f=7+Math.random(),E=Math.min(a,s+f),C=await S(e.id,E);if(s+=7,n("C",`Watching... ${Math.min(s,a).toFixed(0)}/${a}`),C.user_status?.completed_at)break;await c(2e3)}else{for(;s<a;){if(r)return;const f=await _(e.id,e.config.application.id,!1);if(s=f.user_status?.progress?.[t]?.value||s,n("C",`Playing... ${s}/${a}`),f.user_status?.completed_at)break;await c(3e4)}await _(e.id,e.config.application.id,!0)}n("G",`Task ${t} Completed!`)}async function $(e){let t=e;n("G",`Found Quest: ${t.config.messages.quest_name}`),t.user_status?.enrolled_at||(n("Y","Enrolling..."),await k(t.id),await c(1e3),t=(await m()).quests.find(function(a){return a.id===t.id}));const i=Object.keys(t.config.task_config.tasks);for(const a of i){if(r)break;const s=t.config.task_config.tasks[a].target;(t.user_status?.progress?.[a]?.value||0)<s&&(await T(t,a),await c(2e3))}n("G",`Quest ${t.config.messages.quest_name} Done.`)}async function R(){if(!y()){n("R","Error: No Token found.");return}n("Y","Checking for Quests...");try{const e=((await m()).quests||[]).filter(function(t){return!t.user_status?.completed_at&&new Date(t.config.expires_at)>new Date});if(e.length===0){n("X","No active quests found. Stopping.");return}n("Y",`Found ${e.length} active quests.`);for(const t of e){if(r)break;await $(t)}n("G","All operations finished.")}catch(e){n("R",`Error: ${e.message}`)}}var P={onLoad:function(){r=!1,b(),n("C","Auto Quest Plugin Started"),R()},onUnload:function(){r=!0,n("R","Plugin Unloaded.")},settings:v};return l.default=P,Object.defineProperty(l,"__esModule",{value:!0}),l})({},vendetta.metro,vendetta.metro.common,vendetta.plugin);
