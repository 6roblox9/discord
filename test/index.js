(function(v,d,w,i,e,r,$,b){"use strict";const{ScrollView:G}=d.findByProps("ScrollView"),{TableRowGroup:f,TableRow:g,TableSwitchRow:u,Stack:P,TextInput:B}=d.findByProps("TableSwitchRow","TableCheckboxRow","TableRowGroup","Stack","TableRow");e.storage.userIds??=[],e.storage.trackFriends??=!0,e.storage.trackMessages??=!0,e.storage.trackTyping??=!0,e.storage.trackVoice??=!0,e.storage.trackProfile??=!0,e.storage.trackDM??=!0,e.storage.trackGroupDM??=!0,e.storage.trackServers??=!0;function F(){$.useProxy(e.storage);const[,c]=r.React.useReducer(function(t){return t+1},0),[o,T]=r.React.useState(""),a=function(){if(!o.trim()){i.showToast("Please enter a user ID",b.getAssetIDByName("Small"));return}const t=e.storage.userIds||[];t.includes(o.trim())?i.showToast("User ID already exists",b.getAssetIDByName("Warning")):(e.storage.userIds=[...t,o.trim()],T(""),c(),i.showToast("User ID added",b.getAssetIDByName("Check")))},s=function(t){e.storage.userIds=e.storage.userIds.filter(function(n){return n!==t}),c(),i.showToast("User ID removed",b.getAssetIDByName("Check"))};return r.React.createElement(G,{style:{flex:1},contentContainerStyle:{padding:10}},r.React.createElement(P,{spacing:8},r.React.createElement(f,{title:"Tracking Settings"},r.React.createElement(u,{label:"Track Friends",subLabel:"Enable tracking for your friends",value:e.storage.trackFriends,onValueChange:function(t){e.storage.trackFriends=t,c()}}),r.React.createElement(u,{label:"Track Messages",subLabel:"Show notifications when tracked users send messages",value:e.storage.trackMessages,onValueChange:function(t){e.storage.trackMessages=t,c()}}),r.React.createElement(u,{label:"Track Typing",subLabel:"Show notifications when tracked users start typing",value:e.storage.trackTyping,onValueChange:function(t){e.storage.trackTyping=t,c()}}),r.React.createElement(u,{label:"Track Voice",subLabel:"Show notifications when tracked users join voice",value:e.storage.trackVoice,onValueChange:function(t){e.storage.trackVoice=t,c()}}),r.React.createElement(u,{label:"Track Profile",subLabel:"Show notifications when tracked users update profile/status",value:e.storage.trackProfile,onValueChange:function(t){e.storage.trackProfile=t,c()}})),r.React.createElement(f,{title:"Channel Filter"},r.React.createElement(u,{label:"DM",subLabel:"Track activities in direct messages",value:e.storage.trackDM,onValueChange:function(t){e.storage.trackDM=t,c()}}),r.React.createElement(u,{label:"Group DM",subLabel:"Track activities in group chats",value:e.storage.trackGroupDM,onValueChange:function(t){e.storage.trackGroupDM=t,c()}}),r.React.createElement(u,{label:"Servers",subLabel:"Track activities in servers",value:e.storage.trackServers,onValueChange:function(t){e.storage.trackServers=t,c()}})),r.React.createElement(f,{title:"Add User ID"},r.React.createElement(P,{spacing:4},r.React.createElement(B,{placeholder:"Enter user ID",value:o,onChange:T,isClearable:!0,onSubmitEditing:a,returnKeyType:"done"}))),r.React.createElement(f,null,r.React.createElement(g,{label:"Add User ID",subLabel:"Add a specific user ID to track",trailing:r.React.createElement(g.Arrow,null),onPress:a})),e.storage.userIds&&e.storage.userIds.length>0&&r.React.createElement(f,{title:"Tracked User IDs"},e.storage.userIds.map(function(t,n){return r.React.createElement(g,{key:n,label:t,trailing:r.React.createElement(r.ReactNative.TouchableOpacity,{onPress:function(){return s(t)},style:{padding:8,backgroundColor:"#ff4d4d",borderRadius:12,width:24,height:24,justifyContent:"center",alignItems:"center"}},r.React.createElement(r.ReactNative.Image,{source:b.getAssetIDByName("TrashIcon"),style:{width:14,height:14,tintColor:"#ffffff"}}))})})),r.React.createElement(f,{title:"About User Tracking"},r.React.createElement(g,{label:"How it Works",subLabel:"Track specific users by their Discord user IDs"}),r.React.createElement(g,{label:"Finding User IDs",subLabel:"Enable Developer Mode in Discord settings, then open user profile and select three dots in right top, and copy their ID"}),r.React.createElement(g,{label:"Friends vs Specific Users",subLabel:"Enable 'Track Friends' to track all friends, or add specific user IDs"}))))}const l=d.findByProps("dispatch","subscribe"),L=d.findByProps("getStatus"),N=d.findByProps("getFriendIDs"),D=d.findByProps("getChannel"),I=d.findByProps("getGuild"),M=d.findByProps("getUser");e.storage.trackFriends===void 0&&(e.storage.trackFriends=!0),e.storage.userIds||(e.storage.userIds=[]),e.storage.trackMessages===void 0&&(e.storage.trackMessages=!0),e.storage.trackTyping===void 0&&(e.storage.trackTyping=!0),e.storage.trackVoice===void 0&&(e.storage.trackVoice=!0),e.storage.trackProfile===void 0&&(e.storage.trackProfile=!0),e.storage.trackDM===void 0&&(e.storage.trackDM=!0),e.storage.trackGroupDM===void 0&&(e.storage.trackGroupDM=!0),e.storage.trackServers===void 0&&(e.storage.trackServers=!0);const R={},y={},k=function(){const c=new Set;if(e.storage.trackFriends)for(const o of N.getFriendIDs())c.add(o);for(const o of e.storage.userIds)c.add(o);return[...c]},h=function(c){return M.getUser(c)?.username??c},S=function(c){return c.guild_id?e.storage.trackServers:c.type===3?e.storage.trackGroupDM:e.storage.trackDM};let C=null,A=null,_=null,V=null,U=null;var O={onLoad(){for(const a of k()){R[a]=L.getStatus(a);const s=M.getUser(a);s&&(y[a]={username:s.username,avatar:s.avatar})}e.storage.trackProfile&&(A=w.after("dispatch",l,function([a]){if(a?.type!=="USER_UPDATE")return;const s=a.user?.id;if(!k().includes(s))return;const t=y[s],n={username:a.user.username,avatar:a.user.avatar};t&&(t.username!==n.username||t.avatar!==n.avatar)&&i.showToast(`${h(s)} updated their profile`),y[s]=n})),e.storage.trackProfile&&(C=w.after("dispatch",l,function([a]){if(a?.type!=="PRESENCE_UPDATE")return;const s=a.user?.id;k().includes(s)&&R[s]!==a.status&&(R[s]=a.status,i.showToast(`${h(s)} is now ${a.status}`))}));const c=function(a){if(!e.storage.trackMessages)return;const s=a?.message,t=s?.author?.id;if(!k().includes(t))return;const n=D.getChannel(s.channel_id);if(!n||!S(n))return;let E="";n.guild_id?E=`${I.getGuild(n.guild_id)?.name} #${n.name}`:n.type===3?E="group":E="DM",i.showToast(`${h(t)} messaged in ${E}`)},o=function(a){if(!e.storage.trackTyping)return;const s=a?.userId;if(!k().includes(s))return;const t=D.getChannel(a.channelId);if(!t||!S(t))return;let n="";t.guild_id?n=`${I.getGuild(t.guild_id)?.name} #${t.name}`:t.type===3?n="group":n="DM",i.showToast(`${h(s)} typing in ${n}`)},T=function(a){if(!e.storage.trackVoice||a.type!=="VOICE_STATE_UPDATE")return;const s=a.userId;if(!k().includes(s))return;const t=D.getChannel(a.channelId);if(!t||!S(t))return;let n="";t.guild_id?n=`${I.getGuild(t.guild_id)?.name} #${t.name}`:t.type===3?n="group":n="DM",i.showToast(`${h(s)} joined voice in ${n}`)};l.subscribe("MESSAGE_CREATE",c),l.subscribe("TYPING_START",o),l.subscribe("VOICE_STATE_UPDATE",T),_=function(){return l.unsubscribe("MESSAGE_CREATE",c)},V=function(){return l.unsubscribe("TYPING_START",o)},U=function(){return l.unsubscribe("VOICE_STATE_UPDATE",T)}},onUnload(){C?.(),A?.(),_?.(),V?.(),U?.()},settings:F};return v.default=O,Object.defineProperty(v,"__esModule",{value:!0}),v})({},vendetta.metro,vendetta.patcher,vendetta.ui.toasts,vendetta.plugin,vendetta.metro.common,vendetta.storage,vendetta.ui.assets);
