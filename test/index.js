(function(E,i,w,l,e,a,$,v){"use strict";const{ScrollView:G}=i.findByProps("ScrollView"),{TableRowGroup:g,TableRow:D,TableSwitchRow:u,Stack:U,TextInput:B}=i.findByProps("TableSwitchRow","TableRowGroup","TableRow","Stack");e.storage.userIds??=[],e.storage.trackFriends??=!0,e.storage.trackMessages??=!0,e.storage.trackTyping??=!0,e.storage.trackProfile??=!0,e.storage.trackVoice??=!0,e.storage.watchDM??=!0,e.storage.watchGroup??=!0,e.storage.watchServers??=!0;function F(){$.useProxy(e.storage);const[,c]=a.React.useReducer(function(t){return t+1},0),[o,h]=a.React.useState(""),r=function(){o.trim()&&(e.storage.userIds.includes(o.trim())||(e.storage.userIds=[...e.storage.userIds,o.trim()],h(""),c(),l.showToast("User ID added",v.getAssetIDByName("Check"))))},s=function(t){e.storage.userIds=e.storage.userIds.filter(function(n){return n!==t}),c(),l.showToast("User ID removed",v.getAssetIDByName("Check"))};return a.React.createElement(G,{style:{flex:1},contentContainerStyle:{padding:10}},a.React.createElement(U,{spacing:8},a.React.createElement(g,{title:"Tracking Events"},a.React.createElement(u,{label:"Track Profile Changes",value:e.storage.trackProfile,onValueChange:function(t){return e.storage.trackProfile=t}}),a.React.createElement(u,{label:"Track Started Typing",value:e.storage.trackTyping,onValueChange:function(t){return e.storage.trackTyping=t}}),a.React.createElement(u,{label:"Track Sent Message",value:e.storage.trackMessages,onValueChange:function(t){return e.storage.trackMessages=t}}),a.React.createElement(u,{label:"Track Voice Join",value:e.storage.trackVoice,onValueChange:function(t){return e.storage.trackVoice=t}})),a.React.createElement(g,{title:"Channel Scope"},a.React.createElement(u,{label:"DM",value:e.storage.watchDM,onValueChange:function(t){return e.storage.watchDM=t}}),a.React.createElement(u,{label:"Group DM",value:e.storage.watchGroup,onValueChange:function(t){return e.storage.watchGroup=t}}),a.React.createElement(u,{label:"Servers",value:e.storage.watchServers,onValueChange:function(t){return e.storage.watchServers=t}})),a.React.createElement(g,{title:"Users"},a.React.createElement(u,{label:"Track Friends",value:e.storage.trackFriends,onValueChange:function(t){return e.storage.trackFriends=t}})),a.React.createElement(g,{title:"Add User ID"},a.React.createElement(B,{placeholder:"Enter user ID",value:o,onChange:h,onSubmitEditing:r}),a.React.createElement(D,{label:"Add User ID",onPress:r})),e.storage.userIds.length>0&&a.React.createElement(g,{title:"Tracked Users"},e.storage.userIds.map(function(t){return a.React.createElement(D,{key:t,label:t,trailing:a.React.createElement(a.ReactNative.TouchableOpacity,{onPress:function(){return s(t)}},a.React.createElement(a.ReactNative.Image,{source:v.getAssetIDByName("TrashIcon"),style:{width:16,height:16}}))})}))))}const d=i.findByProps("dispatch","subscribe"),N=i.findByProps("getStatus"),O=i.findByProps("getFriendIDs"),R=i.findByProps("getChannel"),I=i.findByProps("getGuild"),P=i.findByProps("getUser");e.storage.trackFriends===void 0&&(e.storage.trackFriends=!0),e.storage.userIds||(e.storage.userIds=[]),e.storage.trackMessages===void 0&&(e.storage.trackMessages=!0),e.storage.trackTyping===void 0&&(e.storage.trackTyping=!0),e.storage.trackVoice===void 0&&(e.storage.trackVoice=!0),e.storage.trackProfile===void 0&&(e.storage.trackProfile=!0),e.storage.trackDM===void 0&&(e.storage.trackDM=!0),e.storage.trackGroupDM===void 0&&(e.storage.trackGroupDM=!0),e.storage.trackServers===void 0&&(e.storage.trackServers=!0);const b={},S={},f=function(){const c=new Set;if(e.storage.trackFriends)for(const o of O.getFriendIDs())c.add(o);for(const o of e.storage.userIds)c.add(o);return[...c]},k=function(c){return P.getUser(c)?.username??c},y=function(c){return c.guild_id?e.storage.trackServers:c.type===3?e.storage.trackGroupDM:e.storage.trackDM};let M=null,C=null,_=null,V=null,A=null;var j={onLoad(){for(const r of f()){b[r]=N.getStatus(r);const s=P.getUser(r);s&&(S[r]={username:s.username,avatar:s.avatar})}e.storage.trackProfile&&(C=w.after("dispatch",d,function([r]){if(r?.type!=="USER_UPDATE")return;const s=r.user?.id;if(!f().includes(s))return;const t=S[s],n={username:r.user.username,avatar:r.user.avatar};t&&(t.username!==n.username||t.avatar!==n.avatar)&&l.showToast(`${k(s)} updated their profile`),S[s]=n})),e.storage.trackProfile&&(M=w.after("dispatch",d,function([r]){if(r?.type!=="PRESENCE_UPDATE")return;const s=r.user?.id;f().includes(s)&&b[s]!==r.status&&(b[s]=r.status,l.showToast(`${k(s)} is now ${r.status}`))}));const c=function(r){if(!e.storage.trackMessages)return;const s=r?.message,t=s?.author?.id;if(!f().includes(t))return;const n=R.getChannel(s.channel_id);if(!n||!y(n))return;let T="";n.guild_id?T=`${I.getGuild(n.guild_id)?.name} #${n.name}`:n.type===3?T="group":T="DM",l.showToast(`${k(t)} messaged in ${T}`)},o=function(r){if(!e.storage.trackTyping)return;const s=r?.userId;if(!f().includes(s))return;const t=R.getChannel(r.channelId);if(!t||!y(t))return;let n="";t.guild_id?n=`${I.getGuild(t.guild_id)?.name} #${t.name}`:t.type===3?n="group":n="DM",l.showToast(`${k(s)} typing in ${n}`)},h=function(r){if(!e.storage.trackVoice||r.type!=="VOICE_STATE_UPDATE")return;const s=r.userId;if(!f().includes(s))return;const t=R.getChannel(r.channelId);if(!t||!y(t))return;let n="";t.guild_id?n=`${I.getGuild(t.guild_id)?.name} #${t.name}`:t.type===3?n="group":n="DM",l.showToast(`${k(s)} joined voice in ${n}`)};d.subscribe("MESSAGE_CREATE",c),d.subscribe("TYPING_START",o),d.subscribe("VOICE_STATE_UPDATE",h),_=function(){return d.unsubscribe("MESSAGE_CREATE",c)},V=function(){return d.unsubscribe("TYPING_START",o)},A=function(){return d.unsubscribe("VOICE_STATE_UPDATE",h)}},onUnload(){M?.(),C?.(),_?.(),V?.(),A?.()},settings:F};return E.default=j,Object.defineProperty(E,"__esModule",{value:!0}),E})({},vendetta.metro,vendetta.patcher,vendetta.ui.toasts,vendetta.plugin,vendetta.metro.common,vendetta.storage,vendetta.ui.assets);
